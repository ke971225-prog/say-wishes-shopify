{{ 'component-product-payment-icons.css' | asset_url | stylesheet_tag }}

<div class="video-product-container">
  <!-- å·¦ä¾§å›¢é˜Ÿå±•ç¤ºåŒºåŸŸ -->
  <div class="team-gallery-section">
    <div class="main-team-display">
      <div class="team-carousel">
        <!-- Team 1 -->
        {% if section.settings.team1_visible %}
          <div class="team-slide" data-team="team1" style="display: block;">
            <div class="image-carousel" data-team="team1">
              {% comment %} æ”¯æŒ10å¼ å›¾ç‰‡å’Œ2ä¸ªè§†é¢‘ {% endcomment %}
              {% assign media_index = 0 %}
              
              {% comment %} è§†é¢‘1 {% endcomment %}
              {% if section.settings.team1_video1 %}
                <video class="carousel-media carousel-video active" data-index="{{ media_index }}" data-type="video" controls muted>
                  <source src="{{ section.settings.team1_video1 }}" type="video/mp4">
                  Your browser does not support the video tag.
                </video>
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% comment %} è§†é¢‘2 {% endcomment %}
              {% if section.settings.team1_video2 %}
                <video class="carousel-media carousel-video{% unless section.settings.team1_video1 %} active{% endunless %}" data-index="{{ media_index }}" data-type="video" controls muted style="{% if section.settings.team1_video1 %}display: none;{% endif %}">
                  <source src="{{ section.settings.team1_video2 }}" type="video/mp4">
                  Your browser does not support the video tag.
                </video>
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% comment %} å›¾ç‰‡1-10 {% endcomment %}
              {% if section.settings.team1_image %}
                <img src="{{ section.settings.team1_image | image_url: width: 800 }}" alt="Personalized African Video Messages - {{ section.settings.team1_name }} Team for Custom Family Greetings" {% if section.settings.team1_video1 or section.settings.team1_video2 %}loading="lazy"{% endif %} class="carousel-media carousel-image{% unless section.settings.team1_video1 or section.settings.team1_video2 %} active{% endunless %}" data-index="{{ media_index }}" data-type="image" style="{% if section.settings.team1_video1 or section.settings.team1_video2 %}display: none;{% endif %}">
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% if section.settings.team1_thumb %}
                <img src="{{ section.settings.team1_thumb | image_url: width: 800 }}" alt="Custom African Birthday Video - {{ section.settings.team1_name }} Personalized Greeting Team" loading="lazy" class="carousel-media carousel-image" data-index="{{ media_index }}" data-type="image" style="display: none;">
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% if section.settings.team1_image3 %}
                <img src="{{ section.settings.team1_image3 | image_url: width: 800 }}" alt="African Video Message Performers - {{ section.settings.team1_name }} Custom Family Celebration Team" loading="lazy" class="carousel-media carousel-image" data-index="{{ media_index }}" data-type="image" style="display: none;">
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% if section.settings.team1_image4 %}
                <img src="{{ section.settings.team1_image4 | image_url: width: 800 }}" alt="Personalized Video Greetings from Africa - {{ section.settings.team1_name }} Professional Team" loading="lazy" class="carousel-media carousel-image" data-index="{{ media_index }}" data-type="image" style="display: none;">
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% if section.settings.team1_image5 %}
                <img src="{{ section.settings.team1_image5 | image_url: width: 800 }}" alt="African Team Video Message - {{ section.settings.team1_name }} Custom Celebration" loading="lazy" class="carousel-media carousel-image" data-index="{{ media_index }}" data-type="image" style="display: none;">
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% if section.settings.team1_image6 %}
                <img src="{{ section.settings.team1_image6 | image_url: width: 800 }}" alt="Personalized African Greetings - {{ section.settings.team1_name }} Team" loading="lazy" class="carousel-media carousel-image" data-index="{{ media_index }}" data-type="image" style="display: none;">
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% if section.settings.team1_image7 %}
                <img src="{{ section.settings.team1_image7 | image_url: width: 800 }}" alt="Custom Video Messages from Africa - {{ section.settings.team1_name }}" loading="lazy" class="carousel-media carousel-image" data-index="{{ media_index }}" data-type="image" style="display: none;">
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% if section.settings.team1_image8 %}
                <img src="{{ section.settings.team1_image8 | image_url: width: 800 }}" alt="African Birthday Video Team - {{ section.settings.team1_name }}" loading="lazy" class="carousel-media carousel-image" data-index="{{ media_index }}" data-type="image" style="display: none;">
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% if section.settings.team1_image9 %}
                <img src="{{ section.settings.team1_image9 | image_url: width: 800 }}" alt="Personalized Greeting Video - {{ section.settings.team1_name }} Team" loading="lazy" class="carousel-media carousel-image" data-index="{{ media_index }}" data-type="image" style="display: none;">
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% if section.settings.team1_image10 %}
                <img src="{{ section.settings.team1_image10 | image_url: width: 800 }}" alt="African Video Message Team - {{ section.settings.team1_name }}" loading="lazy" class="carousel-media carousel-image" data-index="{{ media_index }}" data-type="image" style="display: none;">
                {% assign media_index = media_index | plus: 1 %}
              {% endif %}
              
              {% comment %} å¦‚æœæ²¡æœ‰ä»»ä½•åª’ä½“æ–‡ä»¶ï¼Œæ˜¾ç¤ºå ä½ç¬¦ {% endcomment %}
              {% unless section.settings.team1_video1 or section.settings.team1_video2 or section.settings.team1_image or section.settings.team1_thumb or section.settings.team1_image3 or section.settings.team1_image4 or section.settings.team1_image5 or section.settings.team1_image6 or section.settings.team1_image7 or section.settings.team1_image8 or section.settings.team1_image9 or section.settings.team1_image10 %}
                <div class="placeholder-team">
                  <div class="team-overlay">
                    <h3 class="team-name">{{ section.settings.team1_name | default: 'Pink Lovers' }}</h3>
                  </div>
                </div>
              {% endunless %}
            </div>
            
            {% comment %} è®¡ç®—æ€»åª’ä½“æ•°é‡ {% endcomment %}
            {% assign total_media_count = 0 %}
            {% if section.settings.team1_video1 %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_video2 %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_image %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_thumb %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_image3 %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_image4 %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_image5 %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_image6 %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_image7 %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_image8 %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_image9 %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            {% if section.settings.team1_image10 %}{% assign total_media_count = total_media_count | plus: 1 %}{% endif %}
            
            {% if total_media_count > 1 %}
              <div class="carousel-controls">
                <button class="carousel-btn prev-btn" onclick="changeMedia('team1', -1)">â€¹</button>
                <div class="carousel-dots">
                  {% assign dot_index = 0 %}
                  {% if section.settings.team1_video1 %}<span class="dot{% if dot_index == 0 %} active{% endif %}" onclick="showMedia('team1', {{ dot_index }})" data-type="video"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_video2 %}<span class="dot{% if dot_index == 0 %} active{% endif %}" onclick="showMedia('team1', {{ dot_index }})" data-type="video"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_image %}<span class="dot{% if dot_index == 0 %} active{% endif %}" onclick="showMedia('team1', {{ dot_index }})" data-type="image"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_thumb %}<span class="dot" onclick="showMedia('team1', {{ dot_index }})" data-type="image"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_image3 %}<span class="dot" onclick="showMedia('team1', {{ dot_index }})" data-type="image"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_image4 %}<span class="dot" onclick="showMedia('team1', {{ dot_index }})" data-type="image"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_image5 %}<span class="dot" onclick="showMedia('team1', {{ dot_index }})" data-type="image"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_image6 %}<span class="dot" onclick="showMedia('team1', {{ dot_index }})" data-type="image"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_image7 %}<span class="dot" onclick="showMedia('team1', {{ dot_index }})" data-type="image"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_image8 %}<span class="dot" onclick="showMedia('team1', {{ dot_index }})" data-type="image"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_image9 %}<span class="dot" onclick="showMedia('team1', {{ dot_index }})" data-type="image"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                  {% if section.settings.team1_image10 %}<span class="dot" onclick="showMedia('team1', {{ dot_index }})" data-type="image"></span>{% assign dot_index = dot_index | plus: 1 %}{% endif %}
                </div>
                <button class="carousel-btn next-btn" onclick="changeMedia('team1', 1)">â€º</button>
              </div>
            {% endif %}
          </div>
        {% endif %}
        

      </div>
    </div>
    
>
    
    <!-- Single-team mode: removed left-side team selection info display to avoid duplication -->
    
    <!-- è®¢å•æ­¥éª¤æç¤ºç»„ä»¶ï¼šå·²ç§»é™¤ï¼Œä»…ä¿ç•™å·¦ä¾§è½®æ’­å›¾ç»„ä»¶ -->
  </div>

  <!-- å³ä¾§äº§å“å®šåˆ¶è¡¨å• -->
  <div class="product-customization-section">
    <div class="product-header">
      <h1 class="product-title" style="font-size: {{ section.settings.product_title_font_size | default: 28 }}px; color: {{ section.settings.product_title_color | default: '#333333' }}; font-weight: {{ section.settings.product_title_font_weight | default: 'bold' }};">{{ section.settings.product_title | default: 'Personalized Greeting Video from Africa' }}</h1>
      
      <div class="price-section">
        <span class="current-price" style="font-size: {{ section.settings.current_price_font_size | default: 24 }}px; color: {{ section.settings.current_price_color | default: '#e74c3c' }}; font-weight: {{ section.settings.current_price_font_weight | default: 'bold' }};">${{ section.settings.base_price | default: '46.00' }} USD</span>
        {% if section.settings.original_price %}
          <span class="original-price" style="font-size: {{ section.settings.original_price_font_size | default: 18 }}px; color: {{ section.settings.original_price_color | default: '#999999' }};">${{ section.settings.original_price }} USD</span>
        {% endif %}
        {% if section.settings.discount_percent %}
          <span class="discount-badge" style="font-size: {{ section.settings.discount_badge_font_size | default: 12 }}px; color: {{ section.settings.discount_badge_color | default: '#ffffff' }}; background-color: {{ section.settings.discount_badge_bg_color | default: '#e74c3c' }};">{{ section.settings.discount_percent }}% OFF</span>
        {% endif %}
      </div>
      
      <div class="rating-section">
        <div class="stars">
          {% assign rating = section.settings.rating | default: 5.0 | times: 1.0 %}
          {% assign star_count = section.settings.star_count | default: 5 %}
          {% for i in (1..star_count) %}
            <span class="star {% if i <= rating %}filled{% endif %}" style="font-size: {{ section.settings.star_size | default: 18 }}px; color: {% if i <= rating %}{{ section.settings.star_filled_color | default: '#ffc107' }}{% else %}{{ section.settings.star_empty_color | default: '#e0e0e0' }}{% endif %};">â˜…</span>
          {% endfor %}
          <span class="rating-text" style="font-size: {{ section.settings.rating_text_font_size | default: 14 }}px; color: {{ section.settings.rating_text_color | default: '#666666' }}; font-weight: {{ section.settings.rating_text_font_weight | default: 'normal' }};">{{ section.settings.rating | default: '5.0' }}/{{ star_count }} based on {{ section.settings.review_count | default: '2576' }} reviews</span>
        </div>
      </div>
    </div>

    <form id="video-customization-form" class="customization-form" enctype="multipart/form-data">
      {% comment %} å•å›¢é˜Ÿæ¨¡å¼ï¼šé»˜è®¤é€‰æ‹© team1 {% endcomment %}
      {% assign default_team = 'team1' %}
      {% assign default_team_name = section.settings.team1_name | default: 'Pink Lovers' %}
      
      <input type="hidden" id="selected-team" name="selected_team" value="{{ default_team }}">
      
      <div class="form-section">
        <h3 style="font-size: {{ section.settings.start_customizing_title_font_size | default: 24 }}px; color: {{ section.settings.start_customizing_title_color | default: '#333333' }}; font-weight: {{ section.settings.start_customizing_title_font_weight | default: 'bold' }};">{{ section.settings.start_customizing_title | default: 'Start customizing your video' }}</h3>
        
        <!-- å•å›¢é˜Ÿæ¨¡å¼ï¼šå›¢é˜Ÿä¿¡æ¯ä»…ç”¨äºå±æ€§å†™å…¥ï¼Œç§»é™¤å‰ç«¯å±•ç¤ºå—ä»¥é¿å…é€‰æ‹©è¯¯è§£ -->
        
        <div class="form-group no-frame">
          <label for="photo-count">{{ section.settings.photo_count_label | default: 'How many photos do you want to use?' }}</label>
          <select id="photo-count" name="photo_count" required>
            <option value="1">{{ section.settings.photo_option_1 | default: '1 Photo Included' }}</option>
            <option value="2">{{ section.settings.photo_option_2 | default: '2 Photos (+$5)' }}</option>
            <option value="3">{{ section.settings.photo_option_3 | default: '3 Photos (+$10)' }}</option>
            <option value="4">{{ section.settings.photo_option_4 | default: '4 Photos (+$15)' }}</option>
            <option value="5">{{ section.settings.photo_option_5 | default: '5 Photos (+$20)' }}</option>
          </select>
        </div>

        <div class="photo-upload-section">
          <h4 style="font-weight: bold;">{{ section.settings.upload_text | default: 'Upload photos to be shown in the video' }}</h4>
          
          <!-- å›¾ç‰‡è´¨é‡é€‰æ‹© -->
          <div class="upload-quality-settings">
            <label>Image Quality:</label>
            <select id="image-quality">
              <option value="0.6">High Compression (Faster)</option>
              <option value="0.8" selected>Balanced</option>
              <option value="0.95">High Quality (Slower)</option>
            </select>
          </div>
          
          <div class="upload-area" id="upload-area">
            <div class="upload-placeholder">
            <div class="upload-icon">ğŸ“</div>
            <p class="upload-hint">{{ section.settings.upload_hint | default: 'Drag & drop files here or click to browse' }}</p>
            <button type="button" class="choose-file-btn">{{ section.settings.choose_file | default: 'Choose file' }}</button>
          </div>
            <input type="file" id="photo-input" name="properties[uploaded_photos]" multiple accept="image/*" style="display: none;">
          </div>
          
          <div id="uploaded-photos" class="uploaded-photos"></div>
          
          
          <!-- Privacy Protection Notice -->
          <div class="privacy-protection-notice">
            <div class="privacy-header">
              <span class="privacy-icon">ğŸ”’</span>
              <strong>Privacy Protection: Your photos will be permanently deleted within 24 hours after video delivery</strong>
            </div>
            <div class="privacy-details">
              <span class="privacy-check">âœ“ No backup copies retained</span>
              <span class="privacy-check">âœ“ Minimized data storage risk</span>
              <span class="privacy-check">âœ“ Complete privacy protection</span>
            </div>
          </div>
        </div>

        <div class="form-group no-frame">
          <label for="message-text">{{ section.settings.message_label | default: 'Your text on the poster' }}</label>
          <textarea id="message-text" name="message_text" placeholder="{{ section.settings.message_placeholder | default: 'e.g. Happy Birthday Emma!' }}" maxlength="200" required rows="1"></textarea>
          <div class="char-counter"><span id="char-count">0</span>/200</div>
        </div>

        <div class="form-group no-frame">
          <label for="customer-email">{{ section.settings.email_label | default: 'Your email address' }}</label>
<input type="email" id="customer-email" name="customer_email" placeholder="{{ section.settings.email_placeholder | default: 'Enter your email to receive the video' }}" required>
        </div>

        <div class="form-group no-frame">
          <label class="option-label">{{ section.settings.music_input_title | default: 'Which song should play in the background (if left empty, we will choose for you):' }}</label>
<input type="text" id="background-music-link" name="background_music_link" placeholder="{{ section.settings.music_input_help | default: 'You can paste any song or link; leave blank and we will choose one for you.' }}">
        </div>

        <div class="form-group no-frame">
          <label>{{ section.settings.delivery_label | default: 'Delivery time' }}</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="delivery_speed" value="standard" data-price="0" checked>
              <span class="radio-text">{{ section.settings.standard_delivery_text | default: 'Standard delivery (3-5 days) - Free' }}</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="delivery_speed" value="express" data-price="{{ section.settings.express_delivery_price | default: 10 }}">
              <span class="radio-text">{{ section.settings.express_delivery_text | default: 'Express delivery (1-2 days)' }} - ${{ section.settings.express_delivery_price | default: 10 }}</span>
            </label>
          </div>
        </div>

        <div class="form-group no-frame">
          <label>{{ section.settings.extras_title | default: 'Extras' }}</label>
          <div class="checkbox-group">
            <label class="checkbox-option">
              <input type="checkbox" name="extras[]" value="party-editing" data-price="{{ section.settings.party_editing_price | default: 15 }}">
              <span class="checkbox-text">{{ section.settings.party_editing_text | default: 'Party video editing' }} (+${{ section.settings.party_editing_price | default: 15 }})</span>
            </label>
            <label class="checkbox-option">
              <input type="checkbox" name="extras[]" value="birthday-song" data-price="{{ section.settings.birthday_song_price | default: 10 }}">
              <span class="checkbox-text">{{ section.settings.birthday_song_text | default: 'Sing happy birthday song' }} (+${{ section.settings.birthday_song_price | default: 10 }})</span>
            </label>
            <label class="checkbox-option">
              <input type="checkbox" name="extras[]" value="social-media" data-price="0">
              <span class="checkbox-text">{{ section.settings.social_media_text | default: 'Allow us to post on social media' }}</span>
            </label>
          </div>
        </div>
      </div>

      <div class="order-summary">
        <h4>{{ section.settings.order_summary_title | default: 'Order Summary' }}</h4>
        <div class="price-breakdown">
          <div class="price-item">
            <span>{{ section.settings.base_video_text | default: 'Base video' }}</span>
            <span id="base-price">${{ section.settings.base_price | default: '46.00' }}</span>
          </div>
          <div class="price-item" id="photo-price-item" style="display: none;">
            <span>{{ section.settings.additional_photos_text | default: 'Additional photos' }}</span>
            <span id="photo-price">$0.00</span>
          </div>
          <div class="price-item" id="delivery-price-item" style="display: none;">
            <span>{{ section.settings.express_delivery_summary_text | default: 'Express delivery' }}</span>
            <span id="delivery-price">$0.00</span>
          </div>
          <div class="price-item" id="extras-price-item" style="display: none;">
            <span>{{ section.settings.extras_summary_text | default: 'Extras' }}</span>
            <span id="extras-price">$0.00</span>
          </div>
          <div class="price-total">
            <span>{{ section.settings.total_text | default: 'Total' }}</span>
            <span id="total-price">${{ section.settings.base_price | default: '46.00' }}</span>
          </div>
        </div>
      </div>

      <button type="submit" class="add-to-cart-btn">{{ section.settings.add_to_cart_button_text | default: 'Add to cart' }}</button>
      <button type="button" class="buy-now-btn" id="buy-now-btn">{{ section.settings.buy_now_button_text | default: 'Buy now' }}</button>
      <div class="payment-icons-below-buy-now" aria-hidden="true">
        {% render 'payment-icons', show_heading: false, show_note: false, decorative: true %}
      </div>

      <!-- Secure Info Accordion -->
      <div id="secure-accordion-{{ section.id }}" class="secure-accordion" role="region" aria-label="Secure info">
        {% for block in section.blocks %}
          {% if block.type == 'secure_accordion_item' %}
            <div class="secure-accordion__item" {{ block.shopify_attributes }}>
              <button type="button" class="secure-accordion__header" aria-expanded="false">
                <span class="secure-accordion__title" style="font-size: {{ block.settings.title_font_size | default: 16 }}px; color: {{ block.settings.title_color | default: section.settings.text_color }}; font-weight: {% if block.settings.title_bold %}700{% else %}400{% endif %};">{{ block.settings.title | escape }}</span>
                <span class="secure-accordion__icon" aria-hidden="true">+</span>
              </button>
              <div class="secure-accordion__content">
                <div class="secure-accordion__content-inner rte">
                  {{ block.settings.content }}
                </div>
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>

      <style>
        /* Secure Accordion Styles (scoped by section id) */
        #secure-accordion-{{ section.id }} {
          margin-top: 12px;
          border: 1px solid {{ section.settings.border_color | default: '#e0e0e0' }};
          border-radius: {{ section.settings.border_radius | default: 8 }}px;
          background: {{ section.settings.container_background | default: '#ffffff' }};
        }
        #secure-accordion-{{ section.id }} .secure-accordion__item:not(:last-child) {
          border-bottom: 1px solid {{ section.settings.border_color | default: '#e0e0e0' }};
        }
        #secure-accordion-{{ section.id }} .secure-accordion__header {
          width: 100%;
          padding: 12px 16px;
          background: transparent;
          border: 0;
          display: flex;
          align-items: center;
          justify-content: space-between;
          cursor: pointer;
          color: {{ section.settings.text_color | default: '#333333' }};
        }
        #secure-accordion-{{ section.id }} .secure-accordion__icon {
          font-size: 20px;
          line-height: 1;
          transition: transform 0.25s ease;
          color: {{ section.settings.text_color | default: '#333333' }};
        }
        #secure-accordion-{{ section.id }} .secure-accordion__header[aria-expanded="true"] .secure-accordion__icon {
          transform: rotate(45deg); /* '+' æ—‹è½¬ä¸º 'Ã—' è§†è§‰æ•ˆæœ */
        }
        #secure-accordion-{{ section.id }} .secure-accordion__content {
          max-height: 0;
          overflow: hidden;
          transition: max-height 0.3s ease, opacity 0.3s ease;
          opacity: 0;
        }
        #secure-accordion-{{ section.id }} .secure-accordion__content.is-open {
          opacity: 1;
        }
        #secure-accordion-{{ section.id }} .secure-accordion__content-inner {
          padding: 12px 16px;
          color: {{ section.settings.text_color | default: '#333333' }};
        }
        /* å“åº”å¼ç»†èŠ‚ */
        @media (max-width: 768px) {
          #secure-accordion-{{ section.id }} { border-radius: 6px; }
          #secure-accordion-{{ section.id }} .secure-accordion__header { padding: 10px 14px; }
          #secure-accordion-{{ section.id }} .secure-accordion__content-inner { padding: 10px 14px; }
        }
      </style>

      <script>
        (function() {
          var accordion = document.getElementById('secure-accordion-{{ section.id }}');
          if (!accordion) return;
          var items = accordion.querySelectorAll('.secure-accordion__item');

          // åˆå§‹åŒ–ï¼šç¡®ä¿å†…å®¹åŒºåŸŸå¤„äºå¯åŠ¨ç”»çš„åˆå§‹çŠ¶æ€
          items.forEach(function(item) {
            var content = item.querySelector('.secure-accordion__content');
            if (content) { content.style.maxHeight = 0; }
          });

          function closeAll() {
            items.forEach(function(i) {
              var h = i.querySelector('.secure-accordion__header');
              var c = i.querySelector('.secure-accordion__content');
              if (h) h.setAttribute('aria-expanded', 'false');
              if (c) {
                c.classList.remove('is-open');
                c.style.maxHeight = 0;
              }
            });
          }

          items.forEach(function(item) {
            var header = item.querySelector('.secure-accordion__header');
            var content = item.querySelector('.secure-accordion__content');
            if (!header || !content) return;

            header.addEventListener('click', function() {
              var expanded = header.getAttribute('aria-expanded') === 'true';
              // æ‰‹é£ç´ï¼šå…ˆå…³é—­å…¶ä»–
              closeAll();
              if (!expanded) {
                header.setAttribute('aria-expanded', 'true');
                content.classList.add('is-open');
                content.style.maxHeight = content.scrollHeight + 'px';
              }
            });
          });

          // è‡ªé€‚åº”ï¼šçª—å£å°ºå¯¸å˜åŒ–æ—¶ï¼Œæ›´æ–°æ‰“å¼€é¡¹çš„é«˜åº¦ä»¥é€‚é…å†…å®¹
          window.addEventListener('resize', function() {
            var openHeader = accordion.querySelector('.secure-accordion__header[aria-expanded="true"]');
            if (openHeader) {
              var openContent = openHeader.parentElement.querySelector('.secure-accordion__content');
              if (openContent) {
                openContent.style.maxHeight = openContent.scrollHeight + 'px';
              }
            }
          });
        })();
      </script>
    </form>
  </div>
</div>



<style>

/* åŸºç¡€å®¹å™¨æ ·å¼ */
.video-product-container {
  display: flex;
  max-width: 1200px;
  margin: 0 auto;
  gap: 40px;
  padding: 20px;
  background: {{ section.settings.container_background | default: '#ffffff' }};
  color: {{ section.settings.text_color | default: '#333333' }};
}

/* å›¢é˜Ÿå±•ç¤ºåŒºåŸŸ */
.team-gallery-section {
  flex: 1;
  max-width: 650px; /* å¢åŠ æœ€å¤§å®½åº¦ */
  position: sticky;
  top: 20px;
  align-self: flex-start;
  height: fit-content;
}

.main-team-display {
  margin-bottom: 20px;
}

.team-carousel {
  position: relative;
  border-radius: 12px;
  overflow: hidden;
  background: #f5f5f5;
}

.team-slide {
  width: 100%;
  height: 500px; /* å¢åŠ é«˜åº¦ */
  position: relative;
  border-radius: 12px;
  overflow: hidden;
}

/* ç§»é™¤é‡å¤çš„æ ·å¼ï¼Œä½¿ç”¨.carousel-imageç»Ÿä¸€æ§åˆ¶ */

.placeholder-team {
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, #ff6b9d, #c44569);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.team-overlay {
  text-align: center;
  color: white;
}

.team-name {
  font-size: 24px;
  font-weight: bold;
  margin: 0;
}

/* è½®æ’­æ§åˆ¶æ ·å¼ */
.image-carousel {
  position: relative;
  width: 100%;
  height: 500px; /* å¢åŠ é«˜åº¦ */
}

/* ç»Ÿä¸€åª’ä½“æ ·å¼ */
.carousel-media {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 12px;
  transition: opacity 0.3s ease;
}

/* å›¾ç‰‡æ ·å¼ */
.carousel-image {
  object-fit: cover;
  object-position: center;
}

/* è§†é¢‘æ ·å¼ */
.carousel-video {
  object-fit: cover;
  background: #000;
}

.carousel-video::-webkit-media-controls-panel {
  background-color: rgba(0, 0, 0, 0.8);
}

.carousel-controls {
  position: absolute;
  bottom: 15px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  gap: 15px;
  background: rgba(0, 0, 0, 0.7);
  padding: 8px 15px;
  border-radius: 25px;
  backdrop-filter: blur(10px);
}

.carousel-btn {
  background: rgba(255, 255, 255, 0.2);
  border: none;
  color: white;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  transition: all 0.3s ease;
}

.carousel-btn:hover {
  background: rgba(255, 255, 255, 0.4);
  transform: scale(1.1);
}

.carousel-dots {
  display: flex;
  gap: 8px;
}

.dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.5);
  cursor: pointer;
  transition: all 0.3s ease;
}

.dot.active {
  background: white;
  transform: scale(1.2);
}

.dot:hover {
  background: rgba(255, 255, 255, 0.8);
}

/* Single-team mode: removed legacy left-side team selection display styles */

/* è®¢å•æ­¥éª¤æç¤ºç»„ä»¶æ ·å¼ */
.order-steps-guide {
  margin-top: 20px;
  background: #f8f9fa;
  border-radius: 12px;
  padding: 16px;
  border: 1px solid #e9ecef;
}

.steps-header {
  text-align: center;
  margin-bottom: 15px;
}

.steps-header h4 {
  font-size: 16px;
  font-weight: bold;
  color: #333;
  margin: 0 0 5px 0;
}

.steps-header p {
  font-size: 12px;
  color: #666;
  margin: 0;
}

.steps-carousel {
  position: relative;
  height: 80px;
  overflow: hidden;
  margin-bottom: 12px;
  width: 100%;
}

.steps-carousel-inner {
  display: flex;
  width: 600%; /* 6ä¸ªæ­¥éª¤ Ã— 100% */
  height: 100%;
  transition: transform 0.3s ease;
}

.step-slide {
  min-width: 16.666%; /* 100% / 6 */
  width: 16.666%;
  height: 100%;
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px;
  background: white;
  border-radius: 8px;
  border: 1px solid #e9ecef;
  flex-shrink: 0;
  box-sizing: border-box;
}

.step-icon {
  font-size: 24px;
  flex-shrink: 0;
}

.step-content {
  flex: 1;
}

.step-content h5 {
  font-size: 14px;
  font-weight: bold;
  color: #333;
  margin: 0 0 4px 0;
}

.step-content p {
  font-size: 11px;
  color: #666;
  margin: 0;
  line-height: 1.3;
}

.steps-navigation {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.step-nav-btn {
  background: #fff;
  border: 1px solid #ddd;
  color: #666;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  transition: all 0.3s ease;
}

.step-nav-btn:hover {
  background: #f0f0f0;
  border-color: #ccc;
}

.step-dots {
  display: flex;
  gap: 4px;
}

.step-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #ddd;
  cursor: pointer;
  transition: all 0.3s ease;
}

.step-dot.active {
  background: #ff6b9d;
  transform: scale(1.2);
}

.step-dot:hover {
  background: #bbb;
}

/* äº¤ä»˜è¯´æ˜æ ·å¼ */
.delivery-notice {
  margin-top: 15px;
  background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
  border-radius: 10px;
  padding: 12px 16px;
  border: 1px solid #e1bee7;
}

.delivery-notice-content {
  display: flex;
  align-items: center;
  gap: 10px;
}

.delivery-icon {
  font-size: 18px;
  flex-shrink: 0;
}

.delivery-notice p {
  margin: 0;
  font-size: 12px;
  color: #4a4a4a;
  line-height: 1.4;
  font-weight: 500;
}

/* äº§å“å®šåˆ¶åŒºåŸŸ */
.product-customization-section {
  flex: 1;
  max-width: 600px;
}

.product-header {
  margin-bottom: 4px !important;
}

.product-title {
  margin-bottom: 15px;
  line-height: 1.2;
}

.price-section {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 4px !important;
}

.current-price {
  /* æ ·å¼é€šè¿‡å†…è”æ ·å¼åŠ¨æ€è®¾ç½® */
}

.original-price {
  text-decoration: line-through;
  /* å…¶ä»–æ ·å¼é€šè¿‡å†…è”æ ·å¼åŠ¨æ€è®¾ç½® */
}

.discount-badge {
  padding: 4px 8px;
  border-radius: 4px;
  font-weight: bold;
  /* èƒŒæ™¯è‰²ã€æ–‡å­—é¢œè‰²ã€å­—ä½“å¤§å°é€šè¿‡å†…è”æ ·å¼åŠ¨æ€è®¾ç½® */
}

.rating-section {
  display: flex;
  align-items: center;
  gap: 4px;
}

.stars {
  display: flex;
  align-items: center;
  gap: 4px;
}

.star {
  /* é¢œè‰²å’Œå­—ä½“å¤§å°é€šè¿‡å†…è”æ ·å¼åŠ¨æ€è®¾ç½® */
}

.rating-text {
  margin-left: 8px;
  /* å­—ä½“å¤§å°ã€é¢œè‰²ã€ç²—ç»†é€šè¿‡å†…è”æ ·å¼åŠ¨æ€è®¾ç½® */
}

/* è¡¨å•æ ·å¼ */
.customization-form {
  background: transparent !important;
  padding: 8px 0 !important;
  border-radius: 0 !important;
}

.form-section h3 {
  margin-bottom: 6px !important;
  color: #333;
}

.form-group {
  margin-bottom: 10px !important;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: #333;
}

.form-group input[type="text"],
.form-group input[type="email"],
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 8px !important;
  border: 2px solid {{ section.settings.border_color | default: '#e0e0e0' }};
  border-radius: 6px !important;
  font-size: 14px;
  transition: border-color 0.3s ease;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: {{ section.settings.primary_color | default: '#ff6b9d' }};
}

.form-group textarea {
  resize: vertical;
  min-height: 100px;
}

.char-counter {
  display: none !important;
}

.field-hint {
  display: block;
  font-size: 12px;
  color: #666;
  margin-top: 5px;
  font-style: italic;
}

/* Single-team mode: removed legacy team selection button styles (team-selection-group, team-selection-display, selected-team-info, choose-team-btn) */

/* éšè—çŠ¶æ€ä¸‹çš„å›¢é˜Ÿä¿¡æ¯æ˜¾ç¤ºæ ·å¼ */
.team-info-display {
  background: #f8f9fa;
  padding: 20px;
  border-radius: {{ section.settings.border_radius | default: 8 }}px;
  border: 2px solid {{ section.settings.border_color | default: '#e0e0e0' }};
}

.selected-team-readonly {
  display: flex;
  align-items: center;
  gap: 10px;
}

.selected-team-name {
  font-weight: 500;
  color: #333;
  font-size: 15px;
  padding: 0;
  background: transparent;
  border-radius: 0;
  border: none;
}

/* å“åº”å¼è®¾è®¡ */
/* Single-team mode: removed mobile styles for legacy team selection UI */

.radio-group,
.checkbox-group {
  display: flex;
  flex-direction: column;
  gap: 3px;
}

.radio-option,
.checkbox-option {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px;
  border: none;
  border-radius: 0;
  background: transparent;
  cursor: pointer;
  transition: all 0.3s ease;
}

.radio-option:hover,
.checkbox-option:hover {
  border-color: transparent;
  background: transparent;
}

.radio-option input,
.checkbox-option input {
  margin: 0;
}

.custom-song-group {
  margin-top: 15px;
  padding: 15px;
  background: #fff;
  border-radius: 8px;
  border: 2px solid #e0e0e0;
}

.custom-song-group input {
  margin-bottom: 10px;
}

/* å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ */
.photo-upload-section {
  margin: 8px 0 !important;
}

.upload-quality-settings {
  margin-bottom: 10px !important;
  display: flex;
  align-items: center;
  gap: 10px;
}

.upload-quality-settings label {
  font-size: 14px;
  font-weight: 600;
}

.upload-quality-settings select {
  padding: 8px 12px;
  border: 2px solid #e0e0e0;
  border-radius: 6px;
  font-size: 14px;
}

.upload-area {
  border: 2px dashed #ccc;
  border-radius: 12px;
  padding: 20px 12px !important;
  text-align: center;
  background: #fafafa;
  transition: all 0.3s ease;
  cursor: pointer;
}

.upload-area:hover,
.upload-area.dragover {
  border-color: {{ section.settings.primary_color | default: '#ff6b9d' }};
  background: #fff5f8;
}

.upload-placeholder {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

.upload-icon {
  font-size: 48px;
  opacity: 0.6;
}

.upload-hint {
  color: #666;
  margin: 0;
}

.choose-file-btn {
  background: {{ section.settings.primary_color | default: '#ff6b9d' }};
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: {{ section.settings.button_border_radius | default: 6 }}px;
  cursor: pointer;
  font-weight: 600;
  transition: background 0.3s ease;
}

.choose-file-btn:hover {
  background: {{ section.settings.secondary_color | default: '#e55a87' }};
}

.uploaded-photos {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 16px;
}

/* ä¼˜åŒ–å›¾ç‰‡é¢„è§ˆæ ·å¼ - ä¿æŒå®½é«˜æ¯” */
.photo-preview {
  position: relative;
  width: 120px;
  height: 120px;
  border-radius: 8px;
  overflow: hidden;
  border: 2px solid #e5e5e5;
  background: #f9f9f9;
  transition: all 0.3s ease;
  display: inline-block;
  cursor: pointer;
}

.photo-preview:hover {
  border-color: #007bff;
  transform: scale(1.05);
  box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
}

/* æ¡Œé¢ç«¯æ‚¬åœæ”¾å¤§æ•ˆæœ */
@media (min-width: 768px) {
  .photo-preview {
    cursor: zoom-in;
  }
  
  .photo-preview:hover img {
    transform: scale(1.5);
  }
}

.photo-preview img {
  width: 100%;
  height: 120px;
  object-fit: cover;
  object-position: center;
  transition: opacity 0.3s ease;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
  display: block;
}

/* æ‡’åŠ è½½æ•ˆæœ */
.photo-preview img[data-loading="true"] {
  opacity: 0.5;
  filter: blur(2px);
}

.photo-preview img[data-loaded="true"] {
  opacity: 1;
  filter: none;
}

/* é«˜åˆ†è¾¨ç‡æ˜¾ç¤ºä¼˜åŒ– */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .photo-preview img {
    image-rendering: -webkit-optimize-contrast;
  }
}

.remove-photo {
  position: absolute;
  top: -5px;
  right: -5px;
  background: #ff4757;
  color: white;
  border: none;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  font-size: 12px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.photo-info {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(0, 0, 0, 0.7);
  color: white;
  padding: 2px 4px;
  font-size: 10px;
  text-align: center;
}

/* å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†æ ·å¼ */
.image-preview-modal {
  display: none;
  position: fixed;
  z-index: 9999;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.9);
  backdrop-filter: blur(5px);
  animation: fadeIn 0.3s ease;
}

.image-preview-modal.show {
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-content {
  position: relative;
  max-width: 90vw;
  max-height: 90vh;
  margin: auto;
  animation: zoomIn 0.3s ease;
}

.modal-image {
  width: 100%;
  height: auto;
  max-width: 100%;
  max-height: 90vh;
  object-fit: contain;
  border-radius: 8px;
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
}

.modal-close {
  position: absolute;
  top: -40px;
  right: 0;
  color: white;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
  background: rgba(0, 0, 0, 0.5);
  border: none;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 0.3s ease;
}

.modal-close:hover {
  background: rgba(255, 255, 255, 0.2);
}

.modal-info {
  position: absolute;
  bottom: -50px;
  left: 0;
  right: 0;
  color: white;
  text-align: center;
  font-size: 14px;
  background: rgba(0, 0, 0, 0.7);
  padding: 10px;
  border-radius: 4px;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes zoomIn {
  from { 
    opacity: 0;
    transform: scale(0.8);
  }
  to { 
    opacity: 1;
    transform: scale(1);
  }
}

/* ç§»åŠ¨ç«¯ä¼˜åŒ– */
@media (max-width: 767px) {
  .modal-content {
    max-width: 95vw;
    max-height: 85vh;
  }
  
  .modal-close {
    top: -35px;
    font-size: 24px;
    width: 35px;
    height: 35px;
  }
  
  .modal-info {
    bottom: -40px;
    font-size: 12px;
    padding: 8px;
  }
}

.upload-limit {
  display: none !important;
}

/* éšç§ä¿æŠ¤æç¤ºæ ·å¼ */
.privacy-protection-notice {
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 8px;
  padding: 15px;
  margin-top: 15px;
  font-size: 13px;
}

.privacy-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 10px;
  color: #28a745;
}

.privacy-icon {
  font-size: 16px;
}

.privacy-header strong {
  font-weight: 600;
  color: #495057;
}

.privacy-details {
  display: flex;
  flex-direction: column;
  gap: 5px;
  margin-left: 24px;
}

/* Compact UI adjustments for photo upload area (visual only, no JS changes) */
.upload-icon,
.privacy-icon {
  display: none !important;
}

.upload-area {
  padding: 10px 12px !important;
  border-width: 1px !important;
  border-radius: 8px !important;
}

.upload-placeholder {
  gap: 4px !important;
}

.upload-hint {
  display: none !important;
}

.choose-file-btn {
  padding: 6px 14px !important;
  font-size: 13px !important;
}

.uploaded-photos {
  gap: 4px !important;
  margin-top: 6px !important;
}

.photo-preview {
  width: 80px !important;
  height: 80px !important;
  border-radius: 6px !important;
  border-width: 1px !important;
}

.photo-preview img {
  height: 80px !important;
}

.privacy-protection-notice {
  padding: 8px !important;
  margin-top: 8px !important;
}

/* Hide entire Image Quality row and Privacy Protection notice in compact mode */
.upload-quality-settings {
  display: none !important;
}

.privacy-protection-notice {
  display: none !important;
}

.privacy-header {
  gap: 4px !important;
  margin-bottom: 4px !important;
}

.privacy-check {
  color: #6c757d;
  font-size: 12px;
  display: flex;
  align-items: center;
  gap: 5px;
}

.privacy-check::before {
  content: "";
  display: inline-block;
  width: 4px;
  height: 4px;
  background: #28a745;
  border-radius: 50%;
  margin-right: 3px;
}

.upload-progress {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  padding: 20px;
  background: rgba(255, 107, 157, 0.1);
  border-radius: 8px;
  margin-top: 10px;
}

.progress-spinner {
  width: 20px;
  height: 20px;
  border: 2px solid #ff6b9d;
  border-top: 2px solid transparent;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Global compact form adjustments to fit the whole order form in one page */
.video-product-container {
  gap: 12px !important; /* é¡µé¢ä¸»å®¹å™¨é—´è·æ›´ç´§å‡‘ */
  padding: 12px !important; /* é¡µé¢ä¸»å®¹å™¨å†…è¾¹è·æ›´ç´§å‡‘ */
}

.customization-form {
  padding: 8px 0 !important; /* è¡¨å•å¤–å±‚å†…è¾¹è·æ›´ç´§å‡‘ */
}

.form-section h3 {
  margin-bottom: 3px !important; /* æ ‡é¢˜ä¸å†…å®¹æ›´ç´§å‡‘ */
}

/* ç»Ÿä¸€ä¿¡æ¯æ¡†å®¹å™¨è§†è§‰æ ·å¼ï¼ˆä¸ä¸Šä¼ æ¡†åŒé£æ ¼ï¼‰ï¼šèƒŒæ™¯ã€è¾¹æ¡†ã€åœ†è§’ã€å†…è¾¹è·ä¸æœ€å°é«˜åº¦ */
.form-group {
  margin-bottom: 3px !important; /* åŒºå—é—´è·ç»Ÿä¸€æ›´å° */
  background: #fafafa !important;
  border: 1px solid {{ section.settings.border_color | default: '#e0e0e0' }} !important; /* è¾¹æ¡†ç•¥è–„æ›´è½» */
  border-radius: 10px !important; /* åœ†è§’ç•¥å°ç»Ÿä¸€ */
  padding: 6px !important; /* å®¹å™¨å†…è¾¹è·ç»Ÿä¸€æ›´ç´§å‡‘ */
  min-height: 44px !important; /* æœ€å°é«˜åº¦å†é™ */
}

.form-group label {
  margin-bottom: 2px !important; /* æ ‡ç­¾ä¸è¾“å…¥æ¡†æ›´ç´§å‡‘ */
  font-size: 13px !important;
}

/* æ— å¤–æ¡†æ ·å¼ï¼šç”¨äºé‚®ç®±è¾“å…¥å—ç­‰å»æ¡†åœºæ™¯ */
.form-group.no-frame {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  padding: 2px 0 !important;
  margin-bottom: 4px !important;
}

.form-group input[type="text"],
.form-group input[type="email"],
.form-group select,
.form-group textarea {
  padding: 8px !important;
  font-size: 13px !important;
  border-width: 2px !important;
  border-radius: 12px !important; /* ä¸ä¸Šä¼ æ¡†ä¸€è‡´çš„åœ†è§’ */
  width: 100% !important;
  min-height: 36px !important; /* å†é™æœ€å°é«˜åº¦ä»¥å‹ç¼©æ•´ä½“ */
}

.form-group textarea {
  min-height: 36px !important; /* ä¸é‚®ç®±è¾“å…¥æ¡†ä¸€è‡´é«˜åº¦ */
  height: 36px !important;
  resize: none !important; /* ç¦æ­¢ç”¨æˆ·æ‹–æ‹½æ”¹å˜é«˜åº¦ï¼Œä¿æŒå¸ƒå±€ç»Ÿä¸€ */
}

.char-counter,
.field-hint {
  font-size: 11px !important;
  margin-top: 2px !important;
  line-height: 1.3 !important;
}

/* æ— å¤–æ¡†å®¹å™¨ï¼šç”¨äº Delivery/Extras å»é™¤å¤–éƒ¨æ–¹æ¡† */
.form-group.no-frame {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  padding: 2px 0 !important; /* å†å‹ç¼©ä¸Šä¸‹å†…è¾¹è·ï¼Œè´´è¿‘ç¤ºä¾‹çº¢æ¡†è¦æ±‚ */
  margin-bottom: 6px !important; /* æ— å¤–æ¡†ç»„ä¹‹é—´æ›´ç´§å‡‘ */
}

/* åˆ†ç»„å®¹å™¨ç»Ÿä¸€é£æ ¼ */
.radio-group,
.checkbox-group {
  gap: 3px !important;
  width: 100% !important;
  background: transparent !important;
  border: none !important;
  border-radius: 0 !important;
  padding: 4px 0 !important;
}

/* è®©é…é€é€‰é¡¹æ¨ªå‘æ’åˆ—å¹¶æ›´ç´§å‡‘ */
.radio-group {
  display: flex !important;
  flex-direction: row !important;
  align-items: center !important;
}

.radio-option {
  display: inline-flex !important;
  align-items: center !important;
  gap: 4px !important;
  padding: 4px 6px !important;
}

/* Extras å¤é€‰é¡¹æ›´ç´§å‡‘ */
.checkbox-group {
  display: flex !important;
  flex-direction: column !important; /* ä¿æŒçºµå‘ï¼Œä½†å‹ç¼©é—´è· */
  gap: 4px !important;
}

.radio-option,
.checkbox-option {
  padding: 4px 6px !important;
  gap: 4px !important;
  border: none !important;
  border-radius: 0 !important;
  background: transparent !important;
}

.radio-text,
.checkbox-text {
  font-size: 13px !important;
}

.custom-song-group {
  margin-top: 8px !important;
  padding: 12px !important;
  border: 2px solid {{ section.settings.border_color | default: '#e0e0e0' }} !important;
  border-radius: 12px !important;
  background: #fafafa !important;
}

.custom-song-group input {
  margin-bottom: 6px !important;
}

.order-summary {
  padding: 12px !important;
  margin: 6px 0 !important;
}

.price-breakdown {
  gap: 4px !important;
}

.price-item {
  padding: 4px 0 !important;
}

.price-total {
  padding: 4px 0 !important;
  font-size: 16px !important;
}

.add-to-cart-btn {
  padding: 12px !important;
  font-size: 14px !important;
}

/* æ¡Œé¢ç«¯å¸ƒå±€ï¼šä¸æ”¹å˜DOMé¡ºåºï¼Œä¿æŒè®¢å•æ‘˜è¦åœ¨è¡¨å•å†…éƒ¨ï¼ˆæ·»åŠ åˆ°è´­ç‰©è½¦ä¸Šæ–¹ï¼‰ */
@media (min-width: 992px) {
  .customization-form {
    /* å–æ¶ˆå¼ºåˆ¶ä¸¤åˆ—Gridï¼Œæ¢å¤é»˜è®¤æµå¼å¸ƒå±€ */
    display: block !important;
    gap: 0 !important;
  }
  /* å»é™¤åŒºåŸŸåˆ†é…ä¸ç²˜æ€§å®šä½ */
  .customization-form .form-section { }
  .customization-form .order-summary {
    margin: 6px 0 !important;
    position: static !important;
    top: auto !important;
  }
}

/* Extras å¤é€‰æ¡†åœ¨ä¸­ç­‰ä»¥ä¸Šå±å¹•ä¸¤åˆ—å±•ç¤º */
@media (min-width: 768px) {
  .checkbox-group {
    display: grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 4px !important;
  }
}

/* è®¢å•æ±‡æ€»ï¼ˆä¸ä¸Šä¼ æ¡†ç»Ÿä¸€é£æ ¼ï¼‰ */
.order-summary {
  background: #fafafa !important;
  padding: 10px !important;
  border-radius: 12px !important;
  margin: 4px 0 !important;
  border: 2px solid #e0e0e0 !important;
}

.order-summary h4 {
  margin-bottom: 8px !important;
  color: #333 !important;
}

.price-breakdown {
  display: flex !important;
  flex-direction: column !important;
  gap: 6px !important;
}

.price-item {
  display: flex;
  justify-content: space-between;
  padding: 8px 0;
  border-bottom: 1px solid #eee;
}

.price-total {
  display: flex;
  justify-content: space-between;
  padding: 12px 0;
  font-weight: bold;
  font-size: 18px;
  border-top: 2px solid {{ section.settings.primary_color | default: '#ff6b9d' }};
  color: {{ section.settings.primary_color | default: '#ff6b9d' }};
}

.add-to-cart-btn {
  width: 100%;
  background: {{ section.settings.primary_color | default: '#ff6b9d' }};
  color: white;
  border: none;
  padding: 15px;
  border-radius: {{ section.settings.button_border_radius | default: 8 }}px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
}

.add-to-cart-btn:hover {
  background: {{ section.settings.secondary_color | default: '#e55a87' }};
  transform: translateY(-2px);
}

.add-to-cart-btn:disabled {
  background: #ccc;
  cursor: not-allowed;
  transform: none;
}

/* Buy Now button styles */
.buy-now-btn {
  width: 100%;
  background: {{ section.settings.buy_now_color | default: '#5c3efb' }}; /* configurable */
  color: white;
  border: none;
  padding: 15px;
  border-radius: {{ section.settings.button_border_radius | default: 8 }}px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
  margin-top: 8px; /* small spacing below Add to cart */
}
.buy-now-btn:hover {
  background: {{ section.settings.buy_now_color_hover | default: '#4a2de0' }};
}
.buy-now-btn:disabled {
  background: #ccc;
  cursor: not-allowed;
}

/* Payment icons aligned below Buy now button */
.payment-icons-below-buy-now {
  width: 100%;
  margin-top: 8px;
}
.payment-icons-below-buy-now .list-payment {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 6px;
}
.payment-icons-below-buy-now .list-payment__item {
  margin: 0;
}

.add-to-cart-btn.loading {
  position: relative;
  color: transparent;
}

.add-to-cart-btn.loading::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 20px;
  height: 20px;
  border: 2px solid white;
  border-top: 2px solid transparent;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .video-product-container {
    flex-direction: column;
    gap: 12px;
    padding: 10px;
  }
  
  .team-gallery-section {
    max-width: 100%;
    position: static; /* ç§»é™¤stickyå®šä½ */
    align-self: auto;
    height: auto;
  }
  
  .product-customization-section {
    max-width: 100%;
  }
  
  .team-slide {
    height: 250px;
  }
  
  .image-carousel {
    height: 250px;
  }
  
  .product-title {
    font-size: 24px;
  }
  
  .customization-form {
    padding: 12px;
  }
  
  .radio-group,
  .checkbox-group {
    gap: 4px;
  }
  
  .uploaded-photos {
    justify-content: center;
  }
}
</style>

<script>
  let uploadedPhotos = [];
  let maxPhotos = 1;
  let imageQuality = 0.8;
  let currentTeam = 'team1';
  
  // å›¢é˜Ÿè½®æ’­åˆå§‹åŒ–ï¼ˆå•å›¢é˜Ÿï¼‰
   function initTeamCarousel() {
     const teamSlides = document.querySelectorAll('.team-slide');
     const selectedTeamInput = document.getElementById('selected-team');
     currentTeam = 'team1';
     if (selectedTeamInput) {
       selectedTeamInput.value = currentTeam;
     }
     // éšè—æ‰€æœ‰å¹¶æ˜¾ç¤º team1
     teamSlides.forEach(slide => {
       slide.style.display = 'none';
       slide.classList.remove('active');
     });
     const firstSlide = document.querySelector('.team-slide[data-team="team1"]');
     if (firstSlide) {
       firstSlide.style.display = 'block';
       firstSlide.classList.add('active');
     }
     // å•å›¢é˜Ÿæ¨¡å¼ï¼šå›¢é˜Ÿåç§°ç›´æ¥ä½¿ç”¨ schema é…ç½®ï¼Œæ— éœ€æ›´æ–°å‰ç«¯å±•ç¤ºå…ƒç´ 
   }
  

  
  // è½®æ’­æ§åˆ¶å‡½æ•° - æ”¯æŒè§†é¢‘å’Œå›¾ç‰‡æ··åˆ
  function changeMedia(teamId, direction) {
    const carousel = document.querySelector(`[data-team="${teamId}"] .image-carousel`);
    if (!carousel) return;
    
    const mediaElements = carousel.querySelectorAll('.carousel-media');
    const dots = carousel.parentElement.querySelectorAll('.dot');
    
    if (mediaElements.length <= 1) return;
    
    let currentIndex = 0;
    mediaElements.forEach((media, index) => {
      if (media.classList.contains('active')) {
        currentIndex = index;
      }
    });
    
    let newIndex = currentIndex + direction;
    if (newIndex >= mediaElements.length) newIndex = 0;
    if (newIndex < 0) newIndex = mediaElements.length - 1;
    
    showMedia(teamId, newIndex);
  }
  
  function showMedia(teamId, index) {
    const carousel = document.querySelector(`[data-team="${teamId}"] .image-carousel`);
    if (!carousel) return;
    
    const mediaElements = carousel.querySelectorAll('.carousel-media');
    const dots = carousel.parentElement.querySelectorAll('.dot');
    
    if (index >= mediaElements.length || index < 0) return;
    
    // åœæ­¢æ‰€æœ‰è§†é¢‘æ’­æ”¾
    mediaElements.forEach(media => {
      if (media.tagName === 'VIDEO') {
        media.pause();
        media.currentTime = 0;
      }
      media.classList.remove('active');
      media.style.display = 'none';
    });
    
    // æ˜¾ç¤ºé€‰ä¸­çš„åª’ä½“
    const selectedMedia = mediaElements[index];
    selectedMedia.classList.add('active');
    selectedMedia.style.display = 'block';
    
    // å¦‚æœæ˜¯è§†é¢‘ï¼Œè‡ªåŠ¨æ’­æ”¾
    if (selectedMedia.tagName === 'VIDEO') {
      selectedMedia.play().catch(e => {
        console.log('è§†é¢‘è‡ªåŠ¨æ’­æ”¾å¤±è´¥ï¼Œå¯èƒ½éœ€è¦ç”¨æˆ·äº¤äº’:', e);
      });
    }
    
    // æ›´æ–°æŒ‡ç¤ºç‚¹
    dots.forEach(dot => dot.classList.remove('active'));
    if (dots[index]) dots[index].classList.add('active');
  }
  
  function resetCarousel(teamId) {
    // é‡ç½®è½®æ’­åˆ°ç¬¬ä¸€ä¸ªåª’ä½“
    showMedia(teamId, 0);
  }
  
  // å…¼å®¹æ—§å‡½æ•°å
  function changeImage(teamId, direction) {
    changeMedia(teamId, direction);
  }
  
  function showImage(teamId, index) {
    showMedia(teamId, index);
  }
  
  // è§†é¢‘æ§åˆ¶åŠŸèƒ½
  function initVideoControls() {
    // ä¸ºæ‰€æœ‰è§†é¢‘æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
    document.addEventListener('click', function(e) {
      if (e.target.tagName === 'VIDEO' && e.target.classList.contains('carousel-video')) {
        e.preventDefault();
        toggleVideoPlayback(e.target);
      }
    });
    
    // ç›‘å¬è§†é¢‘æ’­æ”¾çŠ¶æ€å˜åŒ–
    document.addEventListener('play', function(e) {
      if (e.target.tagName === 'VIDEO' && e.target.classList.contains('carousel-video')) {
        // æš‚åœå…¶ä»–æ‰€æœ‰è§†é¢‘
        const allVideos = document.querySelectorAll('.carousel-video');
        allVideos.forEach(video => {
          if (video !== e.target) {
            video.pause();
          }
        });
      }
    }, true);
  }
  
  function toggleVideoPlayback(video) {
    if (video.paused) {
      video.play().catch(e => {
        console.log('è§†é¢‘æ’­æ”¾å¤±è´¥:', e);
      });
    } else {
      video.pause();
    }
  }
  


  document.addEventListener('DOMContentLoaded', function() {
    const uploadArea = document.getElementById('upload-area');
    const photoInput = document.getElementById('photo-input');
    const chooseFileBtn = document.querySelector('.choose-file-btn');
    const photoCountSelect = document.getElementById('photo-count');
    const imageQualitySelect = document.getElementById('image-quality');
    
    // åˆå§‹åŒ–ç…§ç‰‡ä¸Šä¼ è®¾ç½®
    maxPhotos = parseInt(photoCountSelect.value) || 5;
    imageQuality = parseFloat(imageQualitySelect.value) || 0.8;
    
    // åˆå§‹åŒ–ä¸Šä¼ åŒºåŸŸæ–‡æœ¬
    updateUploadAreaText();
    
    // å›¢é˜Ÿè½®æ’­åŠŸèƒ½
    initTeamCarousel();
    
    // åˆå§‹åŒ–è§†é¢‘ç‚¹å‡»æ§åˆ¶
    initVideoControls();
    


    // å›¾ç‰‡è´¨é‡é€‰æ‹©
    imageQualitySelect.addEventListener('change', (e) => {
      imageQuality = parseFloat(e.target.value);
    });

    // ç…§ç‰‡æ•°é‡å˜åŒ–
    photoCountSelect.addEventListener('change', (e) => {
      maxPhotos = parseInt(e.target.value);
      // å¦‚æœå½“å‰ä¸Šä¼ çš„ç…§ç‰‡è¶…è¿‡æ–°çš„é™åˆ¶ï¼Œç§»é™¤å¤šä½™çš„
      if (uploadedPhotos.length > maxPhotos) {
        uploadedPhotos = uploadedPhotos.slice(0, maxPhotos);
        updateUploadedPhotosDisplay();
      }
      // æ›´æ–°ä¸Šä¼ åŒºåŸŸæ–‡æœ¬
      updateUploadAreaText();
      // æ›´æ–°ä»·æ ¼è®¡ç®—
      updatePricing();
    });

    // ç‚¹å‡»é€‰æ‹©æ–‡ä»¶
    chooseFileBtn.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      photoInput.click();
    });

    uploadArea.addEventListener('click', (e) => {
      // åªæœ‰å½“ç‚¹å‡»çš„ä¸æ˜¯æŒ‰é’®æ—¶æ‰è§¦å‘
      if (!e.target.closest('.choose-file-btn')) {
        photoInput.click();
      }
    });

    // æ‹–æ‹½ä¸Šä¼ 
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('dragover');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('dragover');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
      handleFiles(e.dataTransfer.files);
    });

    photoInput.addEventListener('change', (e) => {
      handleFiles(e.target.files);
    });

    // å­—ç¬¦è®¡æ•°å™¨
    const messageText = document.getElementById('message-text');
    const charCount = document.getElementById('char-count');

    messageText.addEventListener('input', () => {
      charCount.textContent = messageText.value.length;
    });

    // èƒŒæ™¯éŸ³ä¹ï¼šæ”¹ä¸ºä¸€ä¸ªå¯é€‰è¾“å…¥æ¡†ï¼Œä¸å†ä½¿ç”¨å•é€‰æŒ‰é’®é€»è¾‘
    // ä¿ç•™å ä½ä»¥é˜²åç»­æ‰©å±•ï¼Œæ— éœ€æ˜¾ç¤º/éšè—å¤„ç†

    // ä»·æ ¼è®¡ç®—
    updatePricing();

    // ç›‘å¬ä»·æ ¼å˜åŒ–
    document.querySelectorAll('input[name="delivery_speed"], input[name="extras[]"]').forEach((input) => {
      input.addEventListener('change', updatePricing);
    });
    
    // ç›‘å¬ç…§ç‰‡æ•°é‡å˜åŒ–çš„ä»·æ ¼æ›´æ–°
    photoCountSelect.addEventListener('change', updatePricing);

    // æ€§èƒ½ç›‘æ§
    monitorImagePerformance();
    preloadTeamImages();
  });

  // å›¾ç‰‡å‹ç¼©å‡½æ•°
  function compressImage(file, quality = 0.8, maxWidth = 1200, maxHeight = 1200) {
    return new Promise((resolve) => {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      const img = new Image();
      
      img.onload = () => {
        // è®¡ç®—æ–°å°ºå¯¸ï¼Œä¿æŒå®½é«˜æ¯”
        let { width, height } = img;
        
        if (width > maxWidth || height > maxHeight) {
          const ratio = Math.min(maxWidth / width, maxHeight / height);
          width *= ratio;
          height *= ratio;
        }
        
        canvas.width = width;
        canvas.height = height;
        
        // ç»˜åˆ¶å¹¶å‹ç¼©å›¾ç‰‡
        ctx.drawImage(img, 0, 0, width, height);
        
        canvas.toBlob((blob) => {
          resolve(blob);
        }, file.type, quality);
      };
      
      img.src = URL.createObjectURL(file);
    });
  }

  // æ˜¾ç¤ºä¸Šä¼ è¿›åº¦
  function showUploadProgress() {
    const uploadArea = document.querySelector('.upload-area');
    if (!document.querySelector('.upload-progress')) {
      const progressDiv = document.createElement('div');
      progressDiv.className = 'upload-progress';
      progressDiv.innerHTML = `
        <div class="progress-spinner"></div>
        <span>Processing image...</span>
      `;
      uploadArea.appendChild(progressDiv);
    }
  }

  function hideUploadProgress() {
    const progress = document.querySelector('.upload-progress');
    if (progress) {
      progress.remove();
    }
  }

  // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
  async function handleFiles(files) {
    const remainingSlots = maxPhotos - uploadedPhotos.length;
    
    if (remainingSlots <= 0) {
      alert(`You have already uploaded ${maxPhotos} photos. Please remove some photos if you want to upload new ones.`);
      return;
    }

    const filesToProcess = Array.from(files).slice(0, remainingSlots);
    
    if (files.length > remainingSlots) {
      alert(`You can only upload ${remainingSlots} more photos. Only the first ${remainingSlots} files will be processed.`);
    }

    for (const file of filesToProcess) {
      // éªŒè¯æ–‡ä»¶ç±»å‹
      if (!file.type.startsWith('image/')) {
        alert(`File "${file.name}" is not an image. Please upload only image files.`);
        continue;
      }

      // éªŒè¯æ–‡ä»¶å¤§å° (10MB)
      if (file.size > 10 * 1024 * 1024) {
        alert(`File "${file.name}" is too large. File size must be less than 10MB.`);
        continue;
      }

      try {
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        showUploadProgress();
        
        // å‹ç¼©å›¾ç‰‡
        const compressedFile = await compressImage(file, imageQuality, 1200, 1200);
        
        const reader = new FileReader();
        reader.onload = (e) => {
          const photoData = {
            file: compressedFile,
            originalFile: file,
            url: e.target.result,
            name: file.name,
            size: compressedFile.size
          };
          uploadedPhotos.push(photoData);
          
          window.uploadedPhotos = uploadedPhotos;
          
          updateUploadedPhotosDisplay();
          updateUploadAreaText();
          hideUploadProgress();
        };
        reader.readAsDataURL(compressedFile);
      } catch (error) {
        console.error('Image compression failed:', error);
        alert(`Failed to process image "${file.name}". Please try again.`);
        hideUploadProgress();
      }
    }
    
    // æ¸…ç©ºæ–‡ä»¶è¾“å…¥ï¼Œå…è®¸é‡å¤é€‰æ‹©ç›¸åŒæ–‡ä»¶
    photoInput.value = '';
  }

  function updateUploadedPhotosDisplay() {
    const container = document.getElementById('uploaded-photos');
    container.innerHTML = '';

    uploadedPhotos.forEach((photo, index) => {
      const photoDiv = document.createElement('div');
      photoDiv.className = 'photo-preview';
      
      // æ·»åŠ å›¾ç‰‡ä¿¡æ¯æ˜¾ç¤º
      const sizeKB = (photo.size / 1024).toFixed(1);
      const originalSizeKB = (photo.originalFile.size / 1024).toFixed(1);
      const compressionRatio = ((1 - photo.size / photo.originalFile.size) * 100).toFixed(0);
      
      photoDiv.innerHTML = `
        <img src="${photo.url}" alt="${photo.name}" loading="lazy"
             data-loading="true" 
             data-photo-index="${index}"
             onclick="openImagePreview('${photo.url}', '${photo.name}', '${sizeKB}KB (${compressionRatio}% compressed)')"
             onload="this.setAttribute('data-loaded', 'true'); this.removeAttribute('data-loading')">
        <button type="button" class="remove-photo" onclick="removePhoto(${index})">Ã—</button>
        <div class="photo-info">
          <small>${sizeKB}KB (${compressionRatio}% compressed)</small>
        </div>
      `;
      container.appendChild(photoDiv);
    });
  }

  function removePhoto(index) {
    uploadedPhotos.splice(index, 1);
    
    window.uploadedPhotos = uploadedPhotos;
    
    updateUploadedPhotosDisplay();
    updateUploadAreaText();
  }

  // æ›´æ–°ä¸Šä¼ åŒºåŸŸæ–‡æœ¬
  function updateUploadAreaText() {
    const uploadText = document.querySelector('.upload-area p');
    const remainingSlots = maxPhotos - uploadedPhotos.length;
    
    if (uploadedPhotos.length === 0) {
      uploadText.textContent = `Drag & drop files here or click to browse (Max ${maxPhotos} photos)`;
    } else if (remainingSlots > 0) {
      uploadText.textContent = `${uploadedPhotos.length}/${maxPhotos} photos uploaded. You can upload ${remainingSlots} more.`;
    } else {
      uploadText.textContent = `${uploadedPhotos.length}/${maxPhotos} photos uploaded. Maximum reached.`;
    }
  }

  // ä»·æ ¼è®¡ç®—
  function updatePricing() {
    // ç›´æ¥ä½¿ç”¨Liquidå˜é‡è·å–åŸºç¡€ä»·æ ¼
    const basePrice = {{ section.settings.base_price | default: 46.00 }};
    let totalPrice = basePrice;

    // ç…§ç‰‡è´¹ç”¨è®¡ç®—
    const photoCount = parseInt(document.getElementById('photo-count').value);
    const photoUnitPrice = {{ section.settings.additional_photo_unit_price | default: 5 }};
    const photoPrice = Math.max(0, (photoCount - 1)) * photoUnitPrice; // ç¬¬ä¸€å¼ å…è´¹ï¼Œä¹‹åæ¯å¼ ä½¿ç”¨å¯é…ç½®å•ä»·

    // å¿«é€’è´¹ç”¨
    const deliveryRadio = document.querySelector('input[name="delivery_speed"]:checked');
    const deliveryPrice = parseFloat(deliveryRadio.dataset.price || 0);

    // é™„åŠ æœåŠ¡è´¹ç”¨
    const extrasCheckboxes = document.querySelectorAll('input[name="extras[]"]:checked');
    let extrasPrice = 0;
    extrasCheckboxes.forEach((checkbox) => {
      extrasPrice += parseFloat(checkbox.dataset.price || 0);
    });

    // æ›´æ–°æ˜¾ç¤º
    const photoPriceItem = document.getElementById('photo-price-item');
    const deliveryPriceItem = document.getElementById('delivery-price-item');
    const extrasPriceItem = document.getElementById('extras-price-item');

    // æ˜¾ç¤ºç…§ç‰‡è´¹ç”¨
    if (photoPrice > 0) {
      photoPriceItem.style.display = 'flex';
      document.getElementById('photo-price').textContent = `$${photoPrice.toFixed(2)}`;
      totalPrice += photoPrice;
    } else {
      photoPriceItem.style.display = 'none';
    }

    if (deliveryPrice > 0) {
      deliveryPriceItem.style.display = 'flex';
      document.getElementById('delivery-price').textContent = `$${deliveryPrice.toFixed(2)}`;
      totalPrice += deliveryPrice;
    } else {
      deliveryPriceItem.style.display = 'none';
    }

    if (extrasPrice > 0) {
      extrasPriceItem.style.display = 'flex';
      document.getElementById('extras-price').textContent = `$${extrasPrice.toFixed(2)}`;
      totalPrice += extrasPrice;
    } else {
      extrasPriceItem.style.display = 'none';
    }

    document.getElementById('total-price').textContent = `$${totalPrice.toFixed(2)}`;
  }

  // æ€§èƒ½ç›‘æ§
  function monitorImagePerformance() {
    if ('PerformanceObserver' in window) {
      const observer = new PerformanceObserver((list) => {
        list.getEntries().forEach((entry) => {
          if (entry.name.includes('blob:')) {
            console.log(`Image load time: ${entry.duration}ms`);
          }
        });
      });
      observer.observe({ entryTypes: ['resource'] });
    }
  }

  // å›¾ç‰‡é¢„åŠ è½½ä¼˜åŒ–
  function preloadTeamImages() {
    const teamImages = document.querySelectorAll('.team-carousel img');
    teamImages.forEach((img) => {
      if (img.dataset.src) {
        const preloadImg = new Image();
        preloadImg.src = img.dataset.src;
      }
    });
  }

  // è¡¨å•æäº¤å¤„ç†
  document.getElementById('video-customization-form').addEventListener('submit', function (e) {
    e.preventDefault();

    // éªŒè¯å¿…å¡«å­—æ®µ
    const messageText = document.getElementById('message-text').value.trim();
    if (!messageText) {
      alert('Please enter your message text.');
      return;
    }

    // éªŒè¯é‚®ç®±å­—æ®µ
    const customerEmail = document.getElementById('customer-email').value.trim();
    if (!customerEmail) {
      alert('Please enter your email address.');
      return;
    }
    
    // éªŒè¯é‚®ç®±æ ¼å¼
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(customerEmail)) {
      alert('Please enter a valid email address.');
      return;
    }

    // éªŒè¯å›¾ç‰‡ä¸Šä¼ 
    const photoCount = parseInt(document.getElementById('photo-count').value);
    if (photoCount > 0 && uploadedPhotos.length !== photoCount) {
      alert(`Please upload exactly ${photoCount} photos.`);
      return;
    }



    // ç¦ç”¨æäº¤æŒ‰é’®ï¼Œæ˜¾ç¤ºåŠ è½½çŠ¶æ€
    const submitButton = document.querySelector('.add-to-cart-btn');
    const originalText = submitButton.textContent;
    submitButton.disabled = true;
    submitButton.textContent = 'Adding to cart...';
    submitButton.classList.add('loading');

    // åˆ›å»ºShopifyæ ‡å‡†FormData
    const formData = new FormData();
    
    // å¿…éœ€çš„äº§å“IDå’Œå˜ä½“IDï¼ˆä¼˜å…ˆä½¿ç”¨productè®¾ç½®ï¼Œå¤‡é€‰ä½¿ç”¨product_variant_idï¼‰
    {% if section.settings.product %}
      formData.append('id', '{{ section.settings.product.selected_or_first_available_variant.id }}');
    {% elsif section.settings.product_variant_id != blank %}
      formData.append('id', '{{ section.settings.product_variant_id }}');
    {% else %}
      console.error('No product or variant ID configured in section settings');
      alert('Product configuration error. Please contact support.');
      submitButton.disabled = false;
      submitButton.textContent = originalText;
      submitButton.classList.remove('loading');
      return;
    {% endif %}
    formData.append('quantity', '1');
    
    // è®¢å•å±æ€§ - ä¿å­˜æ‰€æœ‰å®šåˆ¶ä¿¡æ¯
    // è·å–å®é™…æ˜¾ç¤ºçš„å›¢é˜Ÿåç§°è€Œä¸æ˜¯å›¢é˜ŸID
    const selectedTeamNameEl = document.getElementById('selected-team-name');
const selectedTeamName = selectedTeamNameEl ? selectedTeamNameEl.textContent : '{{ section.settings.team1_name | default: "Muscle Man" }}';
    formData.append('properties[Team]', selectedTeamName);
    formData.append('properties[Message]', messageText);
    formData.append('properties[Photo Count]', photoCount);
    formData.append('properties[Customer Email]', document.getElementById('customer-email').value);
    
    // èƒŒæ™¯éŸ³ä¹ï¼ˆå¯é€‰ï¼‰ï¼šå®¢æˆ·å¡«å†™é“¾æ¥æˆ–æ­Œå
    const backgroundMusic = document.getElementById('background-music-link') ? document.getElementById('background-music-link').value.trim() : '';
    if (backgroundMusic) {
      formData.append('properties[Background Music]', backgroundMusic);
    }
    
    // äº¤ä»˜é€‰é¡¹
    const deliverySpeed = document.querySelector('input[name="delivery_speed"]:checked').value;
    formData.append('properties[Delivery Speed]', deliverySpeed);
    
    // é™„åŠ æœåŠ¡
    const selectedExtras = [];
    document.querySelectorAll('input[name="extras[]"]:checked').forEach((checkbox) => {
      selectedExtras.push(checkbox.value);
    });
    if (selectedExtras.length > 0) {
      formData.append('properties[Extras]', selectedExtras.join(', '));
    }
    
    // ç§»é™¤æ€»ä»·æ ¼å±æ€§ï¼Œè®©Shopifyä½¿ç”¨æ ‡å‡†ä»·æ ¼è®¡ç®—
    // formData.append('properties[Total Price]', document.getElementById('total-price').textContent);
    
    // å¤„ç†å›¾ç‰‡ä¸Šä¼  - å°†å®é™…æ–‡ä»¶æ·»åŠ åˆ°FormData
    if (uploadedPhotos.length > 0) {
      // æ·»åŠ æ–‡ä»¶åä¿¡æ¯åˆ°è®¢å•å±æ€§
      const photoNames = uploadedPhotos.map((photo, index) => `Photo ${index + 1}: ${photo.file.name}`).join(', ');
      formData.append('properties[Uploaded Photos]', photoNames);
      
      // æ·»åŠ å®é™…æ–‡ä»¶åˆ°FormData
      uploadedPhotos.forEach((photo, index) => {
        formData.append(`properties[photo_${index + 1}]`, photo.file, photo.file.name);
      });
    }
    
    // è·å–è´­ç‰©è½¦ç›¸å…³å…ƒç´ 
    const cart = document.querySelector('cart-notification') || document.querySelector('cart-drawer');
    let sectionsToRender = [];
    if (cart) {
      sectionsToRender = cart.getSectionsToRender().map((section) => section.id);
    }

    // å‡†å¤‡è¦æ·»åŠ åˆ°è´­ç‰©è½¦çš„å•†å“æ•°ç»„
    const itemsToAdd = [];
    
    // ä¸»äº§å“ï¼ˆåŸºç¡€è§†é¢‘ï¼‰- åªä¿ç•™åŸºç¡€ä»·æ ¼ï¼Œä¸åŒ…å«é™„åŠ è´¹ç”¨
    const mainProduct = {
      {% if section.settings.product %}
        id: '{{ section.settings.product.selected_or_first_available_variant.id }}',
      {% elsif section.settings.product_variant_id != blank %}
        id: '{{ section.settings.product_variant_id }}',
      {% endif %}
      quantity: 1,
      properties: {
        'Team': selectedTeamName,
        'Message': messageText,
        'Photo Count': photoCount,
        'Customer Email': document.getElementById('customer-email').value,
        'Delivery Speed': deliverySpeed
        // ç§»é™¤ 'Total Price' å±æ€§ï¼Œè®©Shopifyä½¿ç”¨æ ‡å‡†ä»·æ ¼è®¡ç®—
      }
    };
    
    // æ·»åŠ èƒŒæ™¯éŸ³ä¹åˆ°ä¸»äº§å“å±æ€§ï¼ˆå¦‚æœç”¨æˆ·å¡«å†™ï¼‰
    if (backgroundMusic) {
      mainProduct.properties['Background Music'] = backgroundMusic;
    }
    
    // æ·»åŠ é™„åŠ æœåŠ¡ä¿¡æ¯
    if (selectedExtras.length > 0) {
      mainProduct.properties['Extras'] = selectedExtras.join(', ');
    }
    
    // æ·»åŠ å›¾ç‰‡ä¿¡æ¯ï¼ˆåªæ·»åŠ æ–‡ä»¶åï¼Œä¸æ·»åŠ æ–‡ä»¶å¯¹è±¡ï¼‰
    if (uploadedPhotos.length > 0) {
      const photoNames = uploadedPhotos.map((photo, index) => `Photo ${index + 1}: ${photo.file.name}`).join(', ');
      mainProduct.properties['Uploaded Photos'] = photoNames;
      // æ³¨æ„ï¼šæ–‡ä»¶å¯¹è±¡å°†åœ¨FormDataä¸­å•ç‹¬å¤„ç†ï¼Œä¸èƒ½æ·»åŠ åˆ°propertiesä¸­
    }
    
    itemsToAdd.push(mainProduct);
    
    // æ·»åŠ é™„åŠ ç…§ç‰‡æœåŠ¡ï¼ˆå¦‚æœé€‰æ‹©äº†è¶…è¿‡1å¼ ç…§ç‰‡ï¼‰
    const additionalPhotoVariantId = {{ section.settings.additional_photo_variant_id | default: 44965572706483 }};
    if (photoCount > 1 && additionalPhotoVariantId) {
      const additionalPhotos = photoCount - 1;
      for (let i = 0; i < additionalPhotos; i++) {
        itemsToAdd.push({
          id: additionalPhotoVariantId,
          quantity: 1,
          properties: {
            'Related to': selectedTeamName + ' - ' + messageText.substring(0, 20) + '...',
            'Additional Photo': `Photo ${i + 2}`
          }
        });
      }
    }
    
    // æ·»åŠ å¿«é€’æœåŠ¡ï¼ˆå¦‚æœé€‰æ‹©äº†å¿«é€’ï¼‰
    const expressDeliveryVariantId = {{ section.settings.express_delivery_variant_id | default: 44965584109747 }};
    if (deliverySpeed === 'express' && expressDeliveryVariantId) {
      itemsToAdd.push({
        id: expressDeliveryVariantId,
        quantity: 1,
        properties: {
          'Related to': selectedTeamName + ' - ' + messageText.substring(0, 20) + '...',
          'Service': 'Express Delivery (24 hours)'
        }
      });
    }
    
    // æ·»åŠ é€‰ä¸­çš„é™„åŠ æœåŠ¡
    selectedExtras.forEach((extra) => {
      let variantId = '';
      let serviceName = '';
      
      switch(extra) {
        case 'birthday-song':
          variantId = {{ section.settings.birthday_song_variant_id | default: 44965585060019 }}; // Birthday Song Service
          serviceName = 'Birthday Song Service';
          break;
        case 'party-editing':
          variantId = {{ section.settings.party_editing_variant_id | default: 44965585289395 }}; // Party Video Editing
          serviceName = 'Party Video Editing';
          break;
        // å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ æ›´å¤šæœåŠ¡
      }
      
      if (variantId && variantId > 0) {
        itemsToAdd.push({
          id: variantId,
          quantity: 1,
          properties: {
            'Related to': selectedTeamName + ' - ' + messageText.substring(0, 20) + '...',
            'Service': serviceName
          }
        });
      }
    });
    
    // æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶ä¸Šä¼ 
    const hasFileUploads = uploadedPhotos.length > 0;
    
    if (hasFileUploads) {
      // å¦‚æœæœ‰æ–‡ä»¶ä¸Šä¼ ï¼Œä½¿ç”¨FormDataé€ä¸ªæ·»åŠ äº§å“
      // å…ˆæ·»åŠ ä¸»äº§å“ï¼ˆåŒ…å«æ–‡ä»¶ï¼‰
      const mainFormData = new FormData();
      mainFormData.append('id', mainProduct.id);
      mainFormData.append('quantity', mainProduct.quantity);
      
      // æ·»åŠ ä¸»äº§å“å±æ€§ï¼ˆé™¤äº†æ–‡ä»¶ï¼‰
      Object.keys(mainProduct.properties).forEach(key => {
        if (!key.startsWith('photo_')) {
          mainFormData.append(`properties[${key}]`, mainProduct.properties[key]);
        }
      });
      
      // æ·»åŠ æ–‡ä»¶
      uploadedPhotos.forEach((photo, index) => {
        mainFormData.append(`properties[photo_${index + 1}]`, photo.file);
      });
      
      // å…ˆæ·»åŠ ä¸»äº§å“
      fetch('/cart/add.js', {
        method: 'POST',
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        body: mainFormData
      })
      .then(response => response.json())
      .then(response => {
        if (response.status) {
          throw new Error(response.description || 'Error adding main product');
        }
        
        // å¦‚æœæœ‰é™„åŠ æœåŠ¡ï¼Œç»§ç»­æ·»åŠ ï¼ˆä½¿ç”¨JSONæ ¼å¼ï¼‰
        const additionalItems = itemsToAdd.slice(1); // é™¤äº†ä¸»äº§å“çš„å…¶ä»–é¡¹ç›®
        if (additionalItems.length > 0) {
          return fetch('/cart/add.js', {
            method: 'POST',
            headers: {
              'X-Requested-With': 'XMLHttpRequest',
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ items: additionalItems })
          });
        }
        return response;
      })
      .then(response => {
        if (response && response.json) {
          return response.json();
        }
        return response;
      })
      .then(response => {
        if (response && response.status) {
          throw new Error(response.description || 'Error adding additional services');
        }
        
        console.log('All products added successfully');
        
        // If Buy Now mode, go straight to checkout
        if (window.buyNowMode) {
          window.buyNowMode = false;
          window.location = '/checkout';
          return;
        }
        
        // è°ƒç”¨äº§å“é¢„è§ˆå¼¹çª—æ˜¾ç¤ºè´­ç‰©è½¦å†…å®¹
        const productPreviewModal = document.querySelector('product-preview-modal');
        if (productPreviewModal) {
          // é‡æ–°è·å–è´­ç‰©è½¦å†…å®¹å¹¶æ˜¾ç¤ºå¼¹çª—
          fetch('/cart.js')
            .then(res => res.json())
            .then(cartData => {
              productPreviewModal.renderContents(cartData);
              productPreviewModal.open();
            })
            .catch(error => {
              console.error('Error fetching cart data:', error);
              // å¦‚æœè·å–è´­ç‰©è½¦æ•°æ®å¤±è´¥ï¼Œä»ç„¶æ˜¾ç¤ºå¼¹çª—
              productPreviewModal.open();
            });
        } else {
          // å¦‚æœProductPreviewModalä¸å¯ç”¨ï¼Œä½¿ç”¨ä¼ ç»Ÿæ–¹å¼
          if (cart) {
            fetch('/cart.js')
              .then(res => res.json())
              .then(cartData => {
                if (cart.renderContents) {
                  cart.renderContents(cartData);
                }
              });
          } else {
            window.location = window.routes.cart_url;
          }
          alert('Products added to cart successfully!');
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('Error adding products to cart: ' + error.message);
      })
      .finally(() => {
        submitButton.disabled = false;
        submitButton.textContent = originalText;
        submitButton.classList.remove('loading');
      });
      
      return; // é€€å‡ºå‡½æ•°ï¼Œä¸æ‰§è¡Œä¸‹é¢çš„ä»£ç 
    }
    
    // å¦‚æœæ²¡æœ‰æ–‡ä»¶ä¸Šä¼ ï¼Œé‡‡ç”¨ä¸¤æ­¥æ·»åŠ ï¼šå…ˆä¸»äº§å“(æºå¸¦ sections)ï¼Œå†é™„åŠ é¡¹(ä¸æºå¸¦ sections)
    const cartSections = cart ? cart.getSectionsToRender().map((section) => section.id) : [];
    const firstPayload = { items: [mainProduct] };
    if (cartSections.length > 0) {
      firstPayload.sections = cartSections;
      firstPayload.sections_url = window.location.pathname;
    }

    fetch('/cart/add.js', {
      method: 'POST',
      headers: {
        'X-Requested-With': 'XMLHttpRequest',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(firstPayload)
    })
      .then((res) => res.json())
      .then((resp) => {
        if (resp.status) {
          // ä¸»äº§å“æ·»åŠ å¤±è´¥
          console.error('Cart add error (main):', resp);
          throw new Error(resp.description || 'Error adding main product');
        }
        const additionalItems = itemsToAdd.slice(1);
        if (additionalItems.length > 0) {
          return fetch('/cart/add.js', {
            method: 'POST',
            headers: {
              'X-Requested-With': 'XMLHttpRequest',
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ items: additionalItems })
          });
        }
        return resp;
      })
      .then((res) => (res && res.json ? res.json() : res))
      .then((resp) => {
        if (resp && resp.status) {
          console.error('Cart add error (extras):', resp);
          throw new Error(resp.description || 'Error adding additional services');
        }
        
        // æ ¡éªŒè´­ç‰©è½¦åŒ…å«æ‰€æœ‰å¾…æ·»åŠ çš„å˜ä½“
        const expectedVariantIds = itemsToAdd.map((i) => Number(i.id));
        return fetch('/cart.js')
          .then((r) => r.json())
          .then((cartData) => {
            const cartVariantIds = (cartData.items || []).map((li) => Number(li.variant_id));
            const allPresent = expectedVariantIds.every((id) => cartVariantIds.includes(id));

            // Buy Nowï¼šä»…åœ¨å…¨éƒ¨é¡¹å­˜åœ¨æ—¶è·³è½¬ç»“è´¦
            if (window.buyNowMode) {
              window.buyNowMode = false;
              if (allPresent) {
                window.location = '/checkout';
                return;
              } else {
                alert('Not all items were added. Please try again.');
              }
            }

            // æ˜¾ç¤ºè´­ç‰©è½¦é¢„è§ˆ
            const productPreviewModal = document.querySelector('product-preview-modal');
            if (productPreviewModal) {
              productPreviewModal.renderContents(cartData);
              productPreviewModal.open();
            } else {
              const cartElement = document.querySelector('cart-notification') || document.querySelector('cart-drawer');
              if (cartElement && cartElement.renderContents) {
                cartElement.renderContents(cartData);
              } else {
                window.location = window.routes.cart_url;
              }
            }

            alert('Products added to cart successfully!');
          });
      })
      .catch((error) => {
        console.error('Network error:', error);
        alert('Network error. Please try again.');
      })
      .finally(() => {
        // æ¢å¤æäº¤æŒ‰é’®
        submitButton.disabled = false;
        submitButton.textContent = originalText;
        submitButton.classList.remove('loading');
      });
  });



  // è®¢å•æ­¥éª¤è½®æ’­åŠŸèƒ½
  function initOrderStepsCarousel() {
    const carouselInner = document.querySelector('.steps-carousel-inner');
    const slides = document.querySelectorAll('.step-slide');
    const prevBtn = document.querySelector('.step-nav-btn.prev');
    const nextBtn = document.querySelector('.step-nav-btn.next');
    const dots = document.querySelectorAll('.step-dot');
    
    if (!carouselInner || slides.length === 0) return;
    
    let currentSlide = 0;
    const totalSlides = slides.length;
    
    function updateCarousel() {
      // æ›´æ–°è½®æ’­ä½ç½® - æ“ä½œå†…éƒ¨å®¹å™¨
      carouselInner.style.transform = `translateX(-${currentSlide * (100 / totalSlides)}%)`;
      
      // æ›´æ–°æŒ‡ç¤ºç‚¹
      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentSlide);
      });
      
      // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
      if (prevBtn) prevBtn.disabled = currentSlide === 0;
      if (nextBtn) nextBtn.disabled = currentSlide === totalSlides - 1;
    }
    
    function nextSlide() {
      if (currentSlide < totalSlides - 1) {
        currentSlide++;
        updateCarousel();
      }
    }
    
    function prevSlide() {
      if (currentSlide > 0) {
        currentSlide--;
        updateCarousel();
      }
    }
    
    function goToSlide(index) {
      if (index >= 0 && index < totalSlides) {
        currentSlide = index;
        updateCarousel();
      }
    }
    
    // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
    if (nextBtn) nextBtn.addEventListener('click', nextSlide);
    if (prevBtn) prevBtn.addEventListener('click', prevSlide);
    
    dots.forEach((dot, index) => {
      dot.addEventListener('click', () => {
        goToSlide(index); // ç›´æ¥ä½¿ç”¨ç´¢å¼•ï¼Œä¸éœ€è¦è§£ædataset
      });
    });
    
    // è‡ªåŠ¨è½®æ’­ï¼ˆå¯é€‰ï¼‰
    let autoPlayInterval;
    function startAutoPlay() {
      autoPlayInterval = setInterval(() => {
        if (currentSlide < totalSlides - 1) {
          nextSlide();
        } else {
          currentSlide = 0;
          updateCarousel();
        }
      }, 4000); // 4ç§’åˆ‡æ¢ä¸€æ¬¡
    }
    
    function stopAutoPlay() {
      if (autoPlayInterval) {
        clearInterval(autoPlayInterval);
      }
    }
    
    // é¼ æ ‡æ‚¬åœæ—¶åœæ­¢è‡ªåŠ¨æ’­æ”¾
    const orderStepsGuide = document.querySelector('.order-steps-guide');
    if (orderStepsGuide) {
      orderStepsGuide.addEventListener('mouseenter', stopAutoPlay);
      orderStepsGuide.addEventListener('mouseleave', startAutoPlay);
    }
    
    // åˆå§‹åŒ–
    updateCarousel();
    startAutoPlay();
  }
  
  // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–è®¢å•æ­¥éª¤è½®æ’­
  document.addEventListener('DOMContentLoaded', function() {
    initOrderStepsCarousel();
    // Register Buy Now click -> set mode and trigger form submit to reuse validation and add logic
    const buyNowBtn = document.getElementById('buy-now-btn');
    if (buyNowBtn) {
      buyNowBtn.addEventListener('click', function() {
        window.buyNowMode = true;
        const formEl = document.getElementById('video-customization-form');
        if (formEl) {
          // Dispatch submit event to reuse logic
          formEl.dispatchEvent(new Event('submit', { cancelable: true }));
        }
      });
    }
  });

  // å›¾ç‰‡é¢„è§ˆåŠŸèƒ½
  function openImagePreview(imageUrl, imageName, imageInfo) {
    const modal = document.getElementById('imagePreviewModal');
    const modalImage = document.getElementById('modalImage');
    const modalInfo = document.getElementById('modalInfo');
    
    modalImage.src = imageUrl;
    modalImage.alt = imageName;
    modalInfo.textContent = `${imageName} - ${imageInfo}`;
    
    modal.style.display = 'flex';
    
    // æ·»åŠ åŠ¨ç”»ç±»
    setTimeout(() => {
      modal.classList.add('show');
    }, 10);
    
    // é˜»æ­¢èƒŒæ™¯æ»šåŠ¨
    document.body.style.overflow = 'hidden';
  }

  function closeImagePreview() {
    const modal = document.getElementById('imagePreviewModal');
    
    modal.classList.remove('show');
    
    setTimeout(() => {
      modal.style.display = 'none';
      document.body.style.overflow = '';
    }, 300);
  }

  // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
  document.addEventListener('DOMContentLoaded', function() {
    const modal = document.getElementById('imagePreviewModal');
    
    modal.addEventListener('click', function(e) {
      if (e.target === modal) {
        closeImagePreview();
      }
    });
    
    // ESCé”®å…³é—­
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && modal.style.display === 'flex') {
        closeImagePreview();
      }
    });
  });

</script>

{% schema %}
{
  "name": "Custom Product Options",
  "settings": [
    {
      "type": "header",
      "content": "Background Settings"
    },
    {
      "type": "checkbox",
      "id": "enable_gradient_background",
      "label": "Enable Gradient Background",
      "default": false
    },
    {
      "type": "select",
      "id": "gradient_direction",
      "label": "Gradient Direction",
      "options": [
        { "value": "45deg", "label": "45Â°" },
        { "value": "90deg", "label": "90Â° (Top to Bottom)" },
        { "value": "135deg", "label": "135Â°" },
        { "value": "180deg", "label": "180Â° (Left to Right)" },
        { "value": "to right", "label": "Left to Right" },
        { "value": "to bottom", "label": "Top to Bottom" }
      ],
      "default": "135deg"
    },
    {
      "type": "color",
      "id": "gradient_color_start",
      "label": "æ¸å˜å¼€å§‹é¢œè‰²",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "gradient_color_end",
      "label": "æ¸å˜ç»“æŸé¢œè‰²",
      "default": "#f8f9fa"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "çº¯è‰²èƒŒæ™¯é¢œè‰²",
      "default": "#ffffff",
      "info": "å½“æ¸å˜ç¦ç”¨æ—¶ä½¿ç”¨"
    },
    {
      "type": "range",
      "id": "container_padding",
      "label": "å®¹å™¨å†…è¾¹è·",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "container_border_radius",
      "label": "å®¹å™¨è¾¹æ¡†åœ†è§’",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 8
    },
    {
      "type": "header",
      "content": "Shopifyäº§å“è®¾ç½®"
    },
    {
      "type": "product",
      "id": "product",
      "label": "é€‰æ‹©äº§å“"
    },
    {
      "type": "text",
      "id": "product_variant_id",
      "label": "äº§å“å˜ä½“ID",
      "info": "è¾“å…¥åŸºç¡€äº§å“çš„å˜ä½“ID"
    },
    {
      "type": "header",
      "content": "äº§å“ä¿¡æ¯"
    },
    {
      "type": "text",
      "id": "product_title",
      "label": "äº§å“æ ‡é¢˜",
      "default": "Personalized Greeting Video from Africa"
    },
    {
      "type": "text",
      "id": "base_price",
      "label": "åŸºç¡€ä»·æ ¼",
      "default": "46.00"
    },
    {
      "type": "text",
      "id": "original_price",
      "label": "åŸä»·",
      "default": "83.00"
    },
    {
      "type": "text",
      "id": "discount_percent",
      "label": "æŠ˜æ‰£ç™¾åˆ†æ¯”",
      "default": "38"
    },
    {
      "type": "text",
      "id": "rating",
      "label": "è¯„åˆ†",
      "default": "5.0"
    },
    {
      "type": "text",
      "id": "review_count",
      "label": "è¯„è®ºæ•°é‡",
      "default": "2576"
    },
    {
      "type": "header",
      "content": "äº§å“ä¿¡æ¯æ ·å¼è®¾ç½®"
    },
    {
      "type": "header",
      "content": "äº§å“æ ‡é¢˜æ ·å¼"
    },
    {
      "type": "range",
      "id": "product_title_font_size",
      "label": "äº§å“æ ‡é¢˜å­—ä½“å¤§å°",
      "min": 16,
      "max": 48,
      "step": 1,
      "unit": "px",
      "default": 28
    },
    {
      "type": "color",
      "id": "product_title_color",
      "label": "äº§å“æ ‡é¢˜é¢œè‰²",
      "default": "#333333"
    },
    {
      "type": "select",
      "id": "product_title_font_weight",
      "label": "äº§å“æ ‡é¢˜å­—ä½“ç²—ç»†",
      "options": [
        {
          "value": "normal",
          "label": "æ­£å¸¸"
        },
        {
          "value": "bold",
          "label": "åŠ ç²—"
        },
        {
          "value": "600",
          "label": "åŠç²—"
        },
        {
          "value": "700",
          "label": "ç²—ä½“"
        },
        {
          "value": "800",
          "label": "ç‰¹ç²—"
        }
      ],
      "default": "bold"
    },
    {
      "type": "header",
      "content": "ä»·æ ¼æ˜¾ç¤ºæ ·å¼"
    },
    {
      "type": "range",
      "id": "current_price_font_size",
      "label": "å½“å‰ä»·æ ¼å­—ä½“å¤§å°",
      "min": 14,
      "max": 36,
      "step": 1,
      "unit": "px",
      "default": 24
    },
    {
      "type": "color",
      "id": "current_price_color",
      "label": "å½“å‰ä»·æ ¼é¢œè‰²",
      "default": "#e74c3c"
    },
    {
      "type": "select",
      "id": "current_price_font_weight",
      "label": "å½“å‰ä»·æ ¼å­—ä½“ç²—ç»†",
      "options": [
        {
          "value": "normal",
          "label": "æ­£å¸¸"
        },
        {
          "value": "bold",
          "label": "åŠ ç²—"
        },
        {
          "value": "600",
          "label": "åŠç²—"
        },
        {
          "value": "700",
          "label": "ç²—ä½“"
        }
      ],
      "default": "bold"
    },
    {
      "type": "range",
      "id": "original_price_font_size",
      "label": "åŸä»·å­—ä½“å¤§å°",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 18
    },
    {
      "type": "color",
      "id": "original_price_color",
      "label": "åŸä»·é¢œè‰²",
      "default": "#999999"
    },
    {
      "type": "range",
      "id": "discount_badge_font_size",
      "label": "æŠ˜æ‰£æ ‡ç­¾å­—ä½“å¤§å°",
      "min": 10,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 12
    },
    {
      "type": "color",
      "id": "discount_badge_color",
      "label": "æŠ˜æ‰£æ ‡ç­¾æ–‡å­—é¢œè‰²",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "discount_badge_bg_color",
      "label": "æŠ˜æ‰£æ ‡ç­¾èƒŒæ™¯é¢œè‰²",
      "default": "#e74c3c"
    },
    {
      "type": "header",
      "content": "æ˜Ÿçº§è¯„åˆ†æ ·å¼"
    },
    {
      "type": "range",
      "id": "star_count",
      "label": "æ˜Ÿæ˜Ÿæ•°é‡",
      "min": 3,
      "max": 10,
      "step": 1,
      "default": 5,
      "info": "è®¾ç½®æ˜¾ç¤ºçš„æ˜Ÿæ˜Ÿæ€»æ•°"
    },
    {
      "type": "range",
      "id": "star_size",
      "label": "æ˜Ÿæ˜Ÿå¤§å°",
      "min": 12,
      "max": 32,
      "step": 1,
      "unit": "px",
      "default": 18
    },
    {
      "type": "color",
      "id": "star_filled_color",
      "label": "å·²å¡«å……æ˜Ÿæ˜Ÿé¢œè‰²",
      "default": "#ffc107"
    },
    {
      "type": "color",
      "id": "star_empty_color",
      "label": "ç©ºæ˜Ÿæ˜Ÿé¢œè‰²",
      "default": "#e0e0e0"
    },
    {
      "type": "range",
      "id": "rating_text_font_size",
      "label": "è¯„åˆ†æ–‡å­—å¤§å°",
      "min": 10,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "color",
      "id": "rating_text_color",
      "label": "è¯„åˆ†æ–‡å­—é¢œè‰²",
      "default": "#666666"
    },
    {
      "type": "select",
      "id": "rating_text_font_weight",
      "label": "è¯„åˆ†æ–‡å­—ç²—ç»†",
      "options": [
        {
          "value": "normal",
          "label": "æ­£å¸¸"
        },
        {
          "value": "bold",
          "label": "åŠ ç²—"
        },
        {
          "value": "600",
          "label": "åŠç²—"
        }
      ],
      "default": "normal"
    },
    {
      "type": "header",
      "content": "é™„åŠ å®šä»·è®¾ç½®"
    },
    {
      "type": "number",
      "id": "express_delivery_price",
      "label": "å¿«é€’é…é€ä»·æ ¼ (USD)",
      "default": 10,
      "info": "å¿«é€’é…é€ä»·æ ¼ï¼ˆ24å°æ—¶å†…ï¼‰"
    },
    {
      "type": "number",
      "id": "birthday_song_price",
      "label": "ç”Ÿæ—¥æ­Œä»·æ ¼ (USD)",
      "default": 10,
      "info": "å”±ç”Ÿæ—¥å¿«ä¹æ­Œçš„ä»·æ ¼"
    },
    {
      "type": "number",
      "id": "party_editing_price",
      "label": "æ´¾å¯¹è§†é¢‘ç¼–è¾‘ä»·æ ¼ (USD)",
      "default": 5,
      "info": "æ´¾å¯¹è§†é¢‘ç¼–è¾‘çš„ä»·æ ¼"
    },
    {
      "type": "number",
      "id": "additional_photo_unit_price",
      "label": "é¢å¤–ç…§ç‰‡å•ä»· (USD)",
      "default": 5,
      "info": "ç¬¬ä¸€å¼ ä¹‹åæ¯å¼ é¢å¤–ç…§ç‰‡çš„ä»·æ ¼"
    },
    {
      "type": "header",
      "content": "æœåŠ¡å˜ä½“ID"
    },
    {
      "type": "text",
      "id": "additional_photo_variant_id",
      "label": "é¢å¤–ç…§ç‰‡å˜ä½“ID",
      "info": "é¢å¤–ç…§ç‰‡æœåŠ¡çš„å˜ä½“ID"
    },
    {
      "type": "text",
      "id": "express_delivery_variant_id",
      "label": "å¿«é€’é…é€å˜ä½“ID",
      "info": "å¿«é€’é…é€æœåŠ¡çš„å˜ä½“ID"
    },
    {
      "type": "text",
      "id": "birthday_song_variant_id",
      "label": "ç”Ÿæ—¥æ­Œå˜ä½“ID",
      "info": "ç”Ÿæ—¥æ­ŒæœåŠ¡çš„å˜ä½“ID"
    },
    {
      "type": "text",
      "id": "party_editing_variant_id",
      "label": "æ´¾å¯¹ç¼–è¾‘å˜ä½“ID",
      "info": "æ´¾å¯¹è§†é¢‘ç¼–è¾‘æœåŠ¡çš„å˜ä½“ID"
    },
    {
      "type": "header",
      "content": "å›¢é˜Ÿ1è®¾ç½®"
    },
    {
      "type": "image_picker",
      "id": "team1_image",
      "label": "å›¢é˜Ÿ1ä¸»å›¾ç‰‡"
    },
    {
      "type": "image_picker",
      "id": "team1_thumb",
      "label": "å›¢é˜Ÿ1ç¼©ç•¥å›¾"
    },
    {
      "type": "image_picker",
      "id": "team1_image3",
      "label": "å›¢é˜Ÿ1å›¾ç‰‡3"
    },
    {
      "type": "image_picker",
      "id": "team1_image4",
      "label": "å›¢é˜Ÿ1å›¾ç‰‡4"
    },
    {
      "type": "image_picker",
      "id": "team1_image5",
      "label": "å›¢é˜Ÿ1å›¾ç‰‡5"
    },
    {
      "type": "image_picker",
      "id": "team1_image6",
      "label": "å›¢é˜Ÿ1å›¾ç‰‡6"
    },
    {
      "type": "image_picker",
      "id": "team1_image7",
      "label": "å›¢é˜Ÿ1å›¾ç‰‡7"
    },
    {
      "type": "image_picker",
      "id": "team1_image8",
      "label": "å›¢é˜Ÿ1å›¾ç‰‡8"
    },
    {
      "type": "image_picker",
      "id": "team1_image9",
      "label": "å›¢é˜Ÿ1å›¾ç‰‡9"
    },
    {
      "type": "image_picker",
      "id": "team1_image10",
      "label": "å›¢é˜Ÿ1å›¾ç‰‡10"
    },
    {
      "type": "url",
      "id": "team1_video1",
      "label": "å›¢é˜Ÿ1è§†é¢‘1é“¾æ¥",
      "info": "å°†è§†é¢‘ä¸Šä¼ åˆ°Shopifyæ–‡ä»¶å¹¶åœ¨æ­¤ç²˜è´´é“¾æ¥"
    },
    {
      "type": "url",
      "id": "team1_video2",
      "label": "å›¢é˜Ÿ1è§†é¢‘2é“¾æ¥",
      "info": "å°†è§†é¢‘ä¸Šä¼ åˆ°Shopifyæ–‡ä»¶å¹¶åœ¨æ­¤ç²˜è´´é“¾æ¥"
    },
    {
      "type": "text",
      "id": "team1_name",
      "label": "å›¢é˜Ÿ1åç§°",
      "default": "Muscle man"
    },
    {
      "type": "text",
      "id": "team1_description",
      "label": "å›¢é˜Ÿ1æè¿°",
      "default": "Professional team with vibrant energy"
    },
    {
      "type": "checkbox",
      "id": "team1_visible",
      "label": "æ˜¾ç¤ºå›¢é˜Ÿ1",
      "default": true
    },
    {
      "type": "header",
      "content": "è¡¨å•æ ‡ç­¾"
    },
    {
      "type": "text",
      "id": "team_selection_title",
      "label": "å›¢é˜Ÿä¿¡æ¯æ ‡é¢˜",
      "default": "Team:"
    },

    {
      "type": "text",
      "id": "start_customizing_title",
      "label": "å¼€å§‹å®šåˆ¶æ ‡é¢˜",
      "default": "Start customizing your video"
    },
    {
      "type": "header",
      "content": "å®šåˆ¶æ ‡é¢˜æ ·å¼è®¾ç½®"
    },
    {
      "type": "range",
      "id": "start_customizing_title_font_size",
      "label": "å®šåˆ¶æ ‡é¢˜å­—ä½“å¤§å°",
      "min": 16,
      "max": 48,
      "step": 1,
      "unit": "px",
      "default": 24
    },
    {
      "type": "color",
      "id": "start_customizing_title_color",
      "label": "å®šåˆ¶æ ‡é¢˜é¢œè‰²",
      "default": "#333333"
    },
    {
      "type": "select",
      "id": "start_customizing_title_font_weight",
      "label": "å®šåˆ¶æ ‡é¢˜å­—ä½“ç²—ç»†",
      "options": [
        {
          "value": "normal",
          "label": "æ­£å¸¸"
        },
        {
          "value": "bold",
          "label": "åŠ ç²—"
        },
        {
          "value": "600",
          "label": "åŠç²—"
        },
        {
          "value": "700",
          "label": "ç²—ä½“"
        },
        {
          "value": "800",
          "label": "ç‰¹ç²—"
        }
      ],
      "default": "bold"
    },
    {
      "type": "text",
      "id": "photo_count_label",
      "label": "ç…§ç‰‡æ•°é‡æ ‡ç­¾",
      "default": "How many photos do you want to use?"
    },
    {
      "type": "text",
      "id": "message_label",
      "label": "æ¶ˆæ¯æ ‡ç­¾",
      "default": "Your text on the poster"
    },
    {
      "type": "text",
      "id": "message_placeholder",
      "label": "æ¶ˆæ¯å ä½ç¬¦",
      "default": "e.g. Happy Birthday Emma!"
    },
    {
      "type": "text",
      "id": "email_label",
      "label": "é‚®ç®±æ ‡ç­¾",
      "default": "Your email address"
    },
    {
      "type": "text",
      "id": "email_placeholder",
      "label": "é‚®ç®±å ä½ç¬¦",
      "default": "Enter your email to receive the video"
    },
    {
      "type": "text",
      "id": "song_label",
      "label": "æ­Œæ›²æ ‡ç­¾",
      "default": "Choose song"
    },
    {
      "type": "text",
      "id": "delivery_label",
      "label": "é…é€æ ‡ç­¾",
      "default": "Delivery time"
    },
    {
      "type": "text",
      "id": "extras_title",
      "label": "é™„åŠ æœåŠ¡æ ‡é¢˜",
      "default": "Extras"
    },
    {
      "type": "text",
      "id": "add_to_cart_button_text",
      "label": "æ·»åŠ åˆ°è´­ç‰©è½¦æŒ‰é’®æ–‡å­—",
      "default": "Add to cart"
    },
    {
      "type": "header",
      "content": "ä¸Šä¼ è®¾ç½®"
    },
    {
      "type": "text",
      "id": "upload_text",
      "label": "ä¸Šä¼ æ–‡å­—",
      "default": "Upload photos to be shown in the video"
    },
    {
      "type": "text",
      "id": "upload_hint",
      "label": "ä¸Šä¼ æç¤º",
      "default": "Drag & drop files here or click to browse"
    },
    {
      "type": "text",
      "id": "choose_file",
      "label": "é€‰æ‹©æ–‡ä»¶æŒ‰é’®",
      "default": "Choose file"
    },
    {
      "type": "header",
      "content": "é…é€æ—¶é—´è®¾ç½®"
    },
    {
      "type": "text",
      "id": "standard_delivery_text",
      "label": "æ ‡å‡†é…é€æ–‡å­—",
      "default": "Standard delivery (1-2 days) - Free"
    },
    {
      "type": "text",
      "id": "express_delivery_text",
      "label": "å¿«é€Ÿé…é€æ–‡å­—",
      "default": "Express delivery (24 hours)"
    },
    {
      "type": "header",
      "content": "é™„åŠ æœåŠ¡è®¾ç½®"
    },
    {
      "type": "text",
      "id": "party_editing_text",
      "label": "èšä¼šè§†é¢‘ç¼–è¾‘æ–‡å­—",
      "default": "Party video editing"
    },
    {
      "type": "text",
      "id": "birthday_song_text",
      "label": "ç”Ÿæ—¥æ­Œæ–‡å­—",
      "default": "Sing happy birthday song"
    },
    {
      "type": "text",
      "id": "social_media_text",
      "label": "ç¤¾äº¤åª’ä½“æ–‡å­—",
      "default": "Allow us to post on social media"
    },
    {
      "type": "header",
      "content": "èƒŒæ™¯éŸ³ä¹è®¾ç½®"
    },
    {
      "type": "text",
      "id": "music_input_title",
      "label": "èƒŒæ™¯éŸ³ä¹è¾“å…¥æ ‡é¢˜",
      "default": "Which song should play in the background (if left empty, we will choose for you):"
    },
    {
      "type": "text",
      "id": "music_input_help",
      "label": "èƒŒæ™¯éŸ³ä¹å ä½ç¬¦",
      "default": "You can paste any song or link; leave blank and we will choose one for you."
    },
    {
      "type": "text",
      "id": "price_music_label",
      "label": "ä»·æ ¼æ‘˜è¦éŸ³ä¹æ ‡ç­¾",
      "default": "Background music:"
    },
    {
      "type": "header",
      "content": "è®¢å•æ‘˜è¦è®¾ç½®"
    },
    {
      "type": "text",
      "id": "order_summary_title",
      "label": "è®¢å•æ‘˜è¦æ ‡é¢˜",
      "default": "Order Summary"
    },
    {
      "type": "text",
      "id": "base_video_text",
      "label": "åŸºç¡€è§†é¢‘æ–‡å­—",
      "default": "Base video"
    },
    {
      "type": "text",
      "id": "additional_photos_text",
      "label": "é™„åŠ ç…§ç‰‡æ–‡å­—",
      "default": "Additional photos"
    },
    {
      "type": "text",
      "id": "express_delivery_summary_text",
      "label": "å¿«é€Ÿé…é€æ‘˜è¦æ–‡å­—",
      "default": "Express delivery"
    },
    {
      "type": "text",
      "id": "extras_summary_text",
      "label": "é™„åŠ æœåŠ¡æ‘˜è¦æ–‡å­—",
      "default": "Extras"
    },
    {
      "type": "text",
      "id": "total_text",
      "label": "æ€»è®¡æ–‡å­—",
      "default": "Total"
    },
    {
      "type": "text",
      "id": "add_to_cart_text",
      "label": "æ·»åŠ åˆ°è´­ç‰©è½¦æ–‡å­—",
      "default": "Add to cart"
    },
    {
      "type": "header",
      "content": "æ ·å¼è®¾ç½®"
    },
    {
      "type": "color",
      "id": "primary_color",
      "label": "ä¸»è¦é¢œè‰²ï¼ˆæŒ‰é’®ã€é“¾æ¥ï¼‰",
      "default": "#ff6b9d"
    },
    {
      "type": "color",
      "id": "secondary_color",
      "label": "æ¬¡è¦é¢œè‰²ï¼ˆæ‚¬åœçŠ¶æ€ï¼‰",
      "default": "#e55a87"
    },
    {
      "type": "color",
      "id": "form_background_color",
      "label": "è¡¨å•èƒŒæ™¯é¢œè‰²",
      "default": "#f9f9f9"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "è¾¹æ¡†é¢œè‰²",
      "default": "#e0e0e0"
    },
    {
      "type": "range",
      "id": "border_radius",
      "label": "è¾¹æ¡†åœ†è§’ï¼ˆåƒç´ ï¼‰",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 8
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "label": "æŒ‰é’®è¾¹æ¡†åœ†è§’ï¼ˆåƒç´ ï¼‰",
      "min": 0,
      "max": 30,
      "step": 1,
      "default": 8
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "æ–‡å­—é¢œè‰²",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "container_background",
      "label": "å®¹å™¨èƒŒæ™¯é¢œè‰²",
      "default": "#ffffff"
    },

    {
      "type": "header",
      "content": "ç«‹å³è´­ä¹°æŒ‰é’®è®¾ç½®"
    },
    {
      "type": "text",
      "id": "buy_now_button_text",
      "label": "ç«‹å³è´­ä¹°æŒ‰é’®æ–‡å­—",
      "default": "Buy now"
    },
    {
      "type": "color",
      "id": "buy_now_color",
      "label": "ç«‹å³è´­ä¹°æŒ‰é’®é¢œè‰²",
      "default": "#5c3efb"
    },
    {
      "type": "color",
      "id": "buy_now_color_hover",
      "label": "ç«‹å³è´­ä¹°æŒ‰é’®æ‚¬åœé¢œè‰²",
      "default": "#4a2de0"
    }
  ],
  "blocks": [
    {
      "type": "secure_accordion_item",
      "name": "Secure accordion item",
      "settings": [
        { "type": "text", "id": "title", "label": "æ ‡é¢˜" },
        { "type": "range", "id": "title_font_size", "label": "æ ‡é¢˜å­—ä½“å¤§å°", "min": 12, "max": 32, "step": 1, "unit": "px", "default": 16 },
        { "type": "color", "id": "title_color", "label": "æ ‡é¢˜é¢œè‰²", "default": "#333333" },
        { "type": "checkbox", "id": "title_bold", "label": "æ ‡é¢˜åŠ ç²—", "default": true },
        { "type": "richtext", "id": "content", "label": "å†…å®¹", "default": "<p>è¯·åœ¨æ­¤è¾“å…¥è¯´æ˜æ–‡å­—ï¼Œæ”¯æŒåŸºç¡€å¯Œæ–‡æœ¬æ’ç‰ˆã€‚</p>" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Video Product",
      "blocks": [
        { "type": "secure_accordion_item", "settings": { "title": "æ ‡æ³¨", "title_font_size": 16, "title_color": "#333333", "title_bold": true, "content": "<p>åœ¨æ­¤æ·»åŠ ä½ çš„è¯´æ˜æ–‡æœ¬ã€‚</p>" } },
        { "type": "secure_accordion_item", "settings": { "title": "ææ–™ä¸ç»“æ„", "title_font_size": 16, "title_color": "#333333", "title_bold": true, "content": "<p>åœ¨æ­¤æ·»åŠ ä½ çš„ææ–™è¯´æ˜ã€‚</p>" } },
        { "type": "secure_accordion_item", "settings": { "title": "é€€å›", "title_font_size": 16, "title_color": "#333333", "title_bold": true, "content": "<p>é€€è´§è¯´æ˜å†…å®¹ã€‚</p>" } },
        { "type": "secure_accordion_item", "settings": { "title": "å…¶ä»–", "title_font_size": 16, "title_color": "#333333", "title_bold": true, "content": "<p>å…¶ä»–è¯´æ˜ã€‚</p>" } }
      ]
    }
  ]
}
{% endschema %}

<!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
<div id="imagePreviewModal" class="image-preview-modal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeImagePreview()">&times;</button>
    <img id="modalImage" class="modal-image" src="" alt="" loading="lazy">
    <div id="modalInfo" class="modal-info"></div>
  </div>
</div>

<!-- å¼•å…¥äº§å“é¢„è§ˆå¼¹çª—ç»„ä»¶ -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    try {
      var carouselImages = document.querySelectorAll('.image-carousel img.carousel-image');
      carouselImages.forEach(function(img) {
        if (!img.classList.contains('active')) {
          img.setAttribute('loading', 'lazy');
        }
      });
    } catch (e) {
      console.warn('Carousel lazy init failed:', e);
    }
  });
</script>
{% render 'product-preview-modal' %}
